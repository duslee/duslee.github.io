<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="Jeff&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Jeff&#39;s Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jeff&#39;s Blog">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Jeff's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Jeff's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'zS2MTrod2Emy9CFwkkhx','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/10/初学者快速使用SQL(二)/" itemprop="url">
                  初学者快速使用SQL(二)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-10T11:41:38+08:00" content="2016-08-10">
              2016-08-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/translation/" itemprop="url" rel="index">
                    <span itemprop="name">translation</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/translation/sql/" itemprop="url" rel="index">
                    <span itemprop="name">sql</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/10/初学者快速使用SQL(二)/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/10/初学者快速使用SQL(二)/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概述</h1>
<p>本文主要介绍&lt;u&gt;&lt;font color=&quot;red&quot;&gt;索引&lt;/font&gt;&lt;/u&gt;、&lt;u&gt;&lt;font color=&quot;red&quot;&gt;数据类型&lt;/font&gt;&lt;/u&gt;和更多复杂的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;查询结构&lt;/font&gt;&lt;/u&gt;</p>
<p><strong>P.S.</strong>：译自**<code>SQL for Beginners Part 2</code>**&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;</p>
<h1>Database Indexes</h1>
<p><code>Indexes</code>或<code>keys</code>主要用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;提高表的数据获取速度&lt;/font&gt;&lt;/u&gt;。对于指数化数据库的列的大多数原因如下：</p>
<ul>
<li>每个表应该有一个<code>PRIMARY KEY</code>索引，通常作为一个<code>id</code>列</li>
<li>如果一列预计含有唯一的值，那么该列应该有一个<code>UNIQUE</code>索引</li>
<li>如果经常在一列上执行搜索（在<code>WHERE</code>语句里），应该有一个正规的索引</li>
<li>如果一列用于和另一个表的关系，如果可能，该列应该是一个<code>FOREIGN KEY</code>，否则只有一个正规的索引</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>PRIMARY KEY</h2>
<p>几乎每个表都应该有一个<code>PRIMARY KEY</code>，大多数情况下作为一个带<code>AUTO_INCREMENT</code>选项的<code>INT</code></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h2>UNIQUE</h2>
<p>表示该列有唯一的值。默认<code>UNIQUE</code>索引会以列名来命名，也可以指定其它名称</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>),</div><div class="line">  <span class="keyword">UNIQUE</span> (<span class="keyword">name</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>),</div><div class="line">  <span class="keyword">UNIQUE</span> state_name (<span class="keyword">name</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h2>INDEX</h2>
<p>这种类型的索引不具有唯一性的限制</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  join_year <span class="built_in">INT</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>),</div><div class="line">  <span class="keyword">UNIQUE</span> (<span class="keyword">name</span>),</div><div class="line">  <span class="keyword">INDEX</span> (join_year)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>也可以使用<code>KEY</code>代替<code>INDEX</code></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> states (</div><div class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT,</div><div class="line">  <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  join_year <span class="built_in">INT</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>),</div><div class="line">  <span class="keyword">UNIQUE</span> (<span class="keyword">name</span>),</div><div class="line">  <span class="keyword">KEY</span> (join_year)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h2>More About Performance</h2>
<p>添加一个索引减少了<code>INSERT</code>和<code>UPDATE</code>查询的性能，因为每次新数据被添加到表里时，索引数据也自动更新，需要做额外的工作，而在<code>SELECT</code>查询的性能增益通常远大于此。</p>
<h1>Function</h1>
<h2>GROUP BY</h2>
<p><code>GROUP BY</code>语句将获取到的数据行分组</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">GROUP</span> <span class="keyword">BY</span> join_year;</div></pre></td></tr></table></figure></p>
<h2>COUNT(*)</h2>
<p><code>COUNT(*)</code>是结合<code>GROUP BY</code>查询的最常用的函数，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;返回每组的行数&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*), join_year <span class="keyword">FROM</span> states <span class="keyword">GROUP</span> <span class="keyword">BY</span> join_year;</div></pre></td></tr></table></figure></p>
<h2>Grouping Everything</h2>
<p>如果不适用<code>GROUP BY</code>函数或语句，全部的结果会放在单一组里</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> states;</div></pre></td></tr></table></figure></p>
<h2>MIN(), MAX() and AVG()</h2>
<p>这些函数返回&lt;u&gt;&lt;font color=&quot;red&quot;&gt;最小数&lt;/font&gt;&lt;/u&gt;，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;最大数&lt;/font&gt;&lt;/u&gt;和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;平均数&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(population), <span class="keyword">MAX</span>(population), <span class="keyword">AVG</span>(population);</div></pre></td></tr></table></figure></p>
<h2>GROUP_CONCAT()</h2>
<p>将组里所有的值&lt;u&gt;&lt;font color=&quot;red&quot;&gt;使用提供的分隔符连接成一个单一字符串&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">GROUP_CONCAT</span>(<span class="keyword">name</span> SEPERATOR ‘, ‘), join_year</div><div class="line">  <span class="keyword">FROM</span> states <span class="keyword">GROUP</span> <span class="keyword">BY</span> join_year;</div></pre></td></tr></table></figure></p>
<h2>SUM()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;累加数字值&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(population) <span class="keyword">AS</span> usa_population <span class="keyword">FROM</span> states;</div></pre></td></tr></table></figure></p>
<h1>Control Flow</h1>
<h2>IF()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;需要三个参数&lt;/font&gt;&lt;/u&gt;，第一个参数是条件，如果条件为<code>true</code>，使用第二个参数，否则使用第三个参数</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">IF</span>(<span class="literal">true</span>, ‘foo’, ‘bar’);</div></pre></td></tr></table></figure></p>
<h2>CASE</h2>
<p>类似于<code>switch-case</code>语句</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),</div><div class="line"><span class="keyword">CASE</span></div><div class="line">  <span class="keyword">WHEN</span> population &gt; <span class="number">5000000</span> <span class="keyword">THEN</span> ‘<span class="keyword">big</span>’</div><div class="line">  <span class="keyword">WHEN</span> population &gt; <span class="number">1000000</span> <span class="keyword">THEN</span> ‘<span class="keyword">medium</span>’</div><div class="line">  <span class="keyword">ELSE</span> ‘small’ <span class="keyword">END</span></div><div class="line">  <span class="keyword">AS</span> state_size</div><div class="line"><span class="keyword">FROM</span> states <span class="keyword">GROUP</span> <span class="keyword">BY</span> state_size;</div></pre></td></tr></table></figure></p>
<h1>Other</h1>
<h2>Having</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;允许应用条件到隐藏的域上&lt;/font&gt;&lt;/u&gt;，如聚合函数返回的结果，通常和<code>GROUP BY</code>结合使用</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*), join_year <span class="keyword">FROM</span> states</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> join_year</div><div class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt; <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h2>Subqueries</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在获取一个查询的结果后，使用该结果用于其它查询&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">WHERE</span> population = (</div><div class="line">  <span class="keyword">SELECT</span> <span class="keyword">MAX</span>(population) <span class="keyword">FROM</span> states</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p><strong>注意</strong>下面的查询语句和上面查询语句的区别</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">ORDER</span> <span class="keyword">BY</span> population <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h2>IN()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;通过内部查询获取多个结果&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">WHERE</span> join_year <span class="keyword">IN</span> (</div><div class="line">  <span class="keyword">SELECT</span> join_year <span class="keyword">FROM</span> states</div><div class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> join_year</div><div class="line">  <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt; <span class="number">1</span></div><div class="line">) <span class="keyword">ORDER</span> <span class="keyword">BY</span> join_year;</div></pre></td></tr></table></figure></p>
<h2>UNION</h2>
<p>使用<code>UNION</code>查询，可以结合多个<code>SELECT</code>查询的结果</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> ‘n%’)</div><div class="line"><span class="keyword">UNION</span></div><div class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> states <span class="keyword">WHERE</span> population &gt; <span class="number">10000000</span>);</div></pre></td></tr></table></figure></p>
<p><strong>Note</strong>：</p>
<ol>
<li>使用<code>UNION</code>查询的结果只会出现一次，因为重复行自动从查询结果中移除</li>
<li>使用<code>UNION</code>可以在不同的表里结合查询结果</li>
</ol>
<h2>INSERT … ON DUPLICATE KEY UPDATE</h2>
<p>首先执行<code>INSERT</code>，如果因为带<code>PRIMARY KEY或UNIQUE KEY</code>索引的重复值而失败，就去执行<code>UPDATE</code></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> products <span class="keyword">SET</span> <span class="keyword">name</span> = ‘breadmaker’, stock = <span class="number">1</span></div><div class="line"><span class="keyword">ON</span> <span class="keyword">DUPLICATE</span> <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> stock = stock + <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h2>REPLACE INTO</h2>
<p>如果一个重复行被发现，先删除然后再执行<code>INSERT</code></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">REPLACE</span> <span class="keyword">INTO</span> products <span class="keyword">SET</span> <span class="keyword">name</span> = ‘breadmaker’, stock = <span class="number">5</span>;</div></pre></td></tr></table></figure></p>
<h2>INSERT IGNORE</h2>
<p>禁止重复错误的一种方式，通常&lt;u&gt;&lt;font color=&quot;red&quot;&gt;用来阻止应用破坏&lt;/font&gt;&lt;/u&gt;。有时企图添加一个新行，万一有重复行，让该操作直接失败，没有任何抱怨</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">IGNORE</span> <span class="keyword">INTO</span> products <span class="keyword">SET</span> <span class="keyword">name</span> = ‘breadmaker’, stock = <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h1>Date Types</h1>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每个表列需要有一个数据类型&lt;/font&gt;&lt;/u&gt;</p>
<h2>Integer Data Types</h2>
<p>整数列只能&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存放自然数（没有小数点）&lt;/font&gt;&lt;/u&gt;，默认可以是正负数，如果指定了<code>UNSIGNED</code>，则只能存放整数</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>1</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
</tr>
<tr>
<td>INT</td>
<td>4</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
</tr>
</tbody>
</table>
<h2>Non-Integer Numeric Data Types</h2>
<p>这些数据类型可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存放小数&lt;/font&gt;&lt;/u&gt;，如<code>FLOAT</code>、<code>DOUBLE</code>和<code>DECIMAL</code></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;FLOAT&lt;/font&gt;</td>
<td>4字节</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;DOUBLE&lt;/font&gt;</td>
<td>8字节，有更好的进度</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;DECIMAL(M, N)&lt;/font&gt;</td>
<td>有基于精度级别的大小，<code>M</code>是数字的最大位数，<code>N</code>是小数点右边的位数</td>
</tr>
</tbody>
</table>
<h2>String Data Types</h2>
<p>这些数据类型可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存放字符串&lt;/font&gt;&lt;/u&gt;</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;CHAR(N)&lt;/font&gt;</td>
<td>存放N个字符，有一个固定的大小，最多存放255个字符</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;VARCHAR(N)&lt;/font&gt;</td>
<td>存放N个字符，但存储大小不固定，N只是用于最大大小，最多存放65535个字符</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;TEXT&lt;/font&gt;</td>
<td>适合于长字符串，有65535个字符的限制</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;MEDIUMTEXT&lt;/font&gt;</td>
<td>1670W个字符限制</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;LONGTEXT&lt;/font&gt;</td>
<td>43亿个字符限制</td>
</tr>
</tbody>
</table>
<h2>Date Types</h2>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;DATE&lt;/font&gt;</td>
<td>存放日期，以<code>YYYY-MM-DD</code>的格式显示，不包含时间信息；范围从<code>1001-01-01</code>到<code>9999-12-31</code></td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;DATETIME &lt;/font&gt;</td>
<td>包含日期和时间，以<code>YYYY-MM-DD HH:MM:SS</code>的格式显示；范围从<code>1001-01-01 00:00:00</code>到<code>9999-12-31 23:59:59</code>；占8个字节</td>
</tr>
<tr>
<td>&lt;font color=&quot;red&quot;&gt;TIMESTAMP&lt;/font&gt;</td>
<td>占4个字节；范围从<code>1970-01-01 00:00:01</code>到<code>2038-01-19 03:14:07</code></td>
</tr>
</tbody>
</table>
<p>&lt;div id=&quot;footnotes&quot;&gt;&lt;hr&gt;&lt;div id=&quot;footnotelist&quot;&gt;&lt;ol style=&quot;list-style:none; padding-left: 0;&quot;&gt;&lt;li id=&quot;fn:1&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;1.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;<a href="http://code.tutsplus.com/tutorials/sql-for-beginners-part-2--net-8274" target="_blank" rel="external">&lt;strong&gt;SQL for Beginners Part 2&lt;/strong&gt;</a>&lt;/span&gt;&lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/09/初学者快速使用SQL(一)/" itemprop="url">
                  初学者快速使用SQL(一)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-09T19:42:50+08:00" content="2016-08-09">
              2016-08-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/translation/" itemprop="url" rel="index">
                    <span itemprop="name">translation</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/translation/sql/" itemprop="url" rel="index">
                    <span itemprop="name">sql</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/09/初学者快速使用SQL(一)/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/09/初学者快速使用SQL(一)/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概述</h1>
<p><code>SQL</code>，<strong>Structured Query Language</strong>，被设计用于关系型数据库管理系统（<code>RDBMS</code>，<strong>relational database management systems</strong>）的一种语言。</p>
<p><strong>P.S.</strong>：译自**<code>SQL for Beginners</code>**&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;</p>
<h1>基本操作</h1>
<h2>DATABASE</h2>
<h3>CREATE DATABASE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;创建一个数据库&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> my_first_db;</div></pre></td></tr></table></figure></p>
<p>&lt;!-- more --&gt;</p>
<h3>SHOW DATABASES</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;获取所有的数据库列表&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>;</div></pre></td></tr></table></figure></p>
<h3>DROP DATABASE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;删除一个存在的数据库&lt;/font&gt;&lt;/u&gt;，在输入此命令后会直接删除，不会提示</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> my_first_db;</div></pre></td></tr></table></figure></p>
<h3>USE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;选择一个数据库&lt;/font&gt;&lt;/u&gt;，不需要在查询语句后加上<code>;</code></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">USE</span> my_first_db</div></pre></td></tr></table></figure></p>
<h2>Database Table</h2>
<p>数据库表可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存放结构化数据&lt;/font&gt;&lt;/u&gt;，也可对数据进行&lt;u&gt;&lt;font color=&quot;red&quot;&gt;增加&lt;/font&gt;&lt;/u&gt;、&lt;u&gt;&lt;font color=&quot;red&quot;&gt;读取&lt;/font&gt;&lt;/u&gt;、&lt;u&gt;&lt;font color=&quot;red&quot;&gt;更新&lt;/font&gt;&lt;/u&gt;和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;删除&lt;/font&gt;&lt;/u&gt;操作</p>
<h3>CREATE TABLE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;创建数据库表&lt;/font&gt;&lt;/u&gt;，可以使用多行和缩进来完成创建</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> &#123;</div><div class="line">  username <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  create_date <span class="built_in">DATE</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<ol>
<li>
<p><strong>PRIMARY KEY</strong>：用于区分表里的每一行数据</p>
</li>
<li>
<p><strong>AUTO_INCREMENT</strong>：每次添加新行时自动增加一个新的ID数
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> &#123;</div><div class="line">  user_id <span class="built_in">INT</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</div><div class="line">  username <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</div><div class="line">  create_date <span class="built_in">DATE</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>SHOW TABLES</strong>：显示当前数据库里的所有表
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLES</span>;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>EXPLAIN</strong>：查看一个存在的数据库表的结构
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">users</span>;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>DROP TABLE</strong>：删除一个数据库表，没有任何提示
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">users</span>;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>ALTER TABLE</strong>：修改一个数据库表的结构</p>
</li>
</ol>
<ul>
<li>
<p><strong>Add a column</strong>：添加一列
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span></div><div class="line">  <span class="keyword">ADD</span> email <span class="built_in">VARCHAR</span>(<span class="number">100</span>)</div><div class="line">  <span class="keyword">AFTER</span> username;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>Remove a column</strong>：移除一列，没有任何提示
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> <span class="keyword">DROP</span> email;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>Modify a column</strong>：修改一列，即修改该列的属性
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span></div><div class="line">  <span class="keyword">CHANGE</span> username</div><div class="line">  user_name <span class="built_in">VARCHAR</span>(<span class="number">30</span>);</div></pre></td></tr></table></figure></p>
</li>
</ul>
<h3>INSERT</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;添加一些数据到数据库表里&lt;/font&gt;&lt;/u&gt;</p>
<ol>
<li>
<p><strong>VALUES</strong>：存放属性值的列表，使用<code>,</code>隔开；注意主键值为<code>NULL</code>的情况，该值可以自动生成，因为该列设置为<code>AUTO_INCREMENT</code>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span> (</div><div class="line">  <span class="literal">NULL</span>,</div><div class="line">  ‘johndoe’,</div><div class="line">  ‘john@doe.com’,</div><div class="line">  ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-14</span>’</div><div class="line">);</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>Alternate Syntax</strong>：使用<code>SET</code>关键字代替<code>VALUES</code>；注意一列可以被忽略，并且每列必须通过列名被引用
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">SET</span></div><div class="line">  user_name = ‘nettuts’,</div><div class="line">  email = ‘nettuts@gmail.com’,</div><div class="line">  create_date = ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-15</span>’</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>Alternate Syntax 2</strong>：每一列通过列名被引用，可以指定任意的顺序
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> (email, user_name, created_date)</div><div class="line">  <span class="keyword">VALUES</span> (‘foo@bar.com’, ‘foobar’, ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-16</span>’);</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>LAST_INSERT_ID()</strong>：获取当前会话里被插入最后一行的<code>ID</code>值
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">LAST_INSERT_ID</span>();</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>NOW()</strong>：返回当前的日期
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">SET</span></div><div class="line">  create_date = <span class="keyword">NOW</span>(),</div><div class="line">  user_name = ‘batman’,</div><div class="line">  email = ‘bat@man.com’;</div></pre></td></tr></table></figure></p>
</li>
</ol>
<h3>SELECT</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;从一个数据库表里读取数据&lt;/font&gt;&lt;/u&gt;</p>
<ol>
<li>
<p><em><em>Asterisk(</em>)</em>*：从数据库表里获取所有列的数据
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span>;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>WHERE</strong>：筛选出符合条件的某些行数据，如<code>=</code>、<code>&gt;=</code>、<code>&lt;=</code>等条件
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> email <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = ‘nettuts’;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>AND and OR</strong>：组合筛选的条件
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span></div><div class="line">  user_id = <span class="number">1</span> <span class="keyword">OR</span> user_name = ‘nettuts’;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>IN()</strong>：用于匹配多个值
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span></div><div class="line">  create_date <span class="keyword">IN</span> (‘<span class="number">2009</span><span class="number">-12</span><span class="number">-15</span>’, ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-16</span>’);</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>LIKE</strong>：通配符（<code>%</code>标记）查找
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span></div><div class="line">  email <span class="keyword">LIKE</span> ‘%tuts%’;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>ORDER BY</strong>：获取指定顺序的结果，如增序（<code>ASC</code>）、降序（<code>DESC</code>）等
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span></div><div class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> create_date;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>LIMIT … OFFSET …</strong>：限制返回结果的数目，如<code>LIMIT 2</code>表示获取前两条结果，<code>LIMIT 1 OFFSET 2</code>表示在前两条结果后获取一条结果，<code>LIMIT2, 1</code>表示在前一条结果后获取两条结果
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">LIMIT</span> <span class="number">2</span>;</div></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">2</span>;</div></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">LIMIT</span> <span class="number">2</span>, <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h3>UPDATE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;更新数据库表里的数据&lt;/font&gt;&lt;/u&gt;，可以结合<code>WHERE</code>和<code>LIMIT</code>语句</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> <span class="keyword">users</span> <span class="keyword">SET</span></div><div class="line">  email = ‘<span class="keyword">changed</span>@gmail.cm’,</div><div class="line">  user_name = ‘barfoo’,</div><div class="line">  <span class="keyword">WHERE</span> user_name = ‘foobar’;</div></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> <span class="keyword">users</span> <span class="keyword">SET</span> create_date = ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-01</span>’</div><div class="line">  <span class="keyword">WHERE</span> create_date = ‘<span class="number">2009</span><span class="number">-12</span><span class="number">-14</span>’ <span class="keyword">LIMIT</span> <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<h3>DELETE</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;结合<code>WHERE</code>语句来删除数据库表里的数据&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = ‘batman’;</div></pre></td></tr></table></figure></p>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;通常使用TRUNCATE更有效&lt;/font&gt;&lt;/u&gt;，可以重置<code>AUTO_INCREMENT</code>数，即一个新行的<code>ID</code>值为1，而<code>DELETE</code>会继续计数</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span>;</div></pre></td></tr></table></figure></p>
<h1>转移字符和特殊单词</h1>
<h2>转义字符串</h2>
<p>某些字符需要被转义，可以使用<code>\</code>来实现</p>
<h2>特殊单词</h2>
<p>因MySQL有很多如<code>SELECT</code>或<code>UPDATE</code>等特殊单词，可以通过<code>`</code>来避免冲突</p>
<p>&lt;div id=&quot;footnotes&quot;&gt;&lt;hr&gt;&lt;div id=&quot;footnotelist&quot;&gt;&lt;ol style=&quot;list-style:none; padding-left: 0;&quot;&gt;&lt;li id=&quot;fn:1&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;1.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;<a href="http://code.tutsplus.com/tutorials/sql-for-beginners--net-8200" target="_blank" rel="external">&lt;strong&gt;SQL for Beginners&lt;/strong&gt;</a>&lt;/span&gt;&lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/31/greenDAO使用总结/" itemprop="url">
                  greenDAO使用总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-31T09:04:32+08:00" content="2016-07-31">
              2016-07-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/tool/" itemprop="url" rel="index">
                    <span itemprop="name">tool</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/tool/greenDAO/" itemprop="url" rel="index">
                    <span itemprop="name">greenDAO</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/31/greenDAO使用总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/31/greenDAO使用总结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>此文档主要描述<code>greenDAO 3</code>的相关概念及使用，包括&lt;u&gt;&lt;font color=&quot;red&quot;&gt;项目中的配置、数据操作（增删改查）&lt;/font&gt;&lt;/u&gt;等。</p>
<h1>配置</h1>
<h2>与greenDAO 2的区别</h2>
<p><code>greenDAO 2</code>（之前的版本）需要开发者在工程中另建一个独立的<code>Java生成器</code>项目（需要使用到<code>“greendao-generator”</code>依赖，来自动生成greenDAO需用的代码），然而<code>greenDAO 3</code>只需使用<code>注解</code>定义实体类，然后通过<code>gradle插件</code>就可以生成代码</p>
<p>&lt;!-- more --&gt;</p>
<h2>greenDAO 3的配置</h2>
<h3>添加gradle插件到buildscript</h3>
<p>在工程的<code>build.gradle</code>文件中添加gradle插件到<code>buildscript</code>块中</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">  dependencies &#123;</div><div class="line">    classpath ‘org.greenrobot:greendao-gradle-plugin:<span class="number">3.0</span>.0’</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3>根模块中使用gradle插件</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在根模块的build.gradle文件中使用gradle插件&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">apply plugin ‘org.greenrobot.greendao’</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">  compile ‘org.greenrobot:greendao:<span class="number">3.0</span>.1’</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3>gradle插件的配置</h3>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在根模块的build.gradle文件中配置greendao&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">greendao &#123;</div><div class="line">  schemaVersion <span class="number">2</span></div><div class="line">  daoPackage ‘…’</div><div class="line">  targetGenDir ‘…’</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li><strong>schemaVersion</strong>：指定数据库<code>schema</code>的当前版本号，被<code>*OpenHelpers</code>类使用，用于在不同的schema版本号之间迁移，如果修改了<code>Entity</code>或数据库的schema，该值必须增加，默认是1</li>
<li><strong>daoPackage</strong>：用于存放生成的<code>DAO</code>、<code>DaoMaster</code>和<code>DaoSession</code>的包名，默认是源Entities的包名</li>
<li><strong>targetGenDir</strong>：生成的源码应存放的位置，默认是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;build目录下的generated文件夹&lt;/font&gt;&lt;/u&gt;下（<code>build/generated/source/greendao</code>）</li>
<li><strong>generateTests</strong>：设置为<code>true</code>时自动生成单元测试代码</li>
<li><strong>targetGenGenTest</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;生成单元测试代码的存放位置&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h3>Gradle插件实现步骤</h3>
<p>每次在<code>make</code>工程时，Gradle插件会扫描工程中所有的<code>@Entity</code>文件（greenDAO用到的数据库实体类），并根据实体类生成<code>DaoMaster</code>、<code>DaoSession</code>以及所有实体类的<code>DAO类</code>，生成的文件默认目录为<code>build/generated/source/greendao</code></p>
<h1>基本概念</h1>
<h2>@Entity</h2>
<p><code>@Entity</code>注解&lt;u&gt;&lt;font color=&quot;red&quot;&gt;标记一个Java类为持久的实体&lt;/font&gt;&lt;/u&gt;，可以配置如下参数</p>
<ol>
<li><strong>schema</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;告诉greenDAO该实体属于哪个schema&lt;/font&gt;&lt;/u&gt;（<strong>Note</strong>：当使用Gradle插件时目前不支持多个schemas）</li>
<li><strong>active</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;标记一个Entity的激活状态&lt;/font&gt;&lt;/u&gt;，激活的Entity有更新/删除/刷新方法</li>
<li><strong>nameInDb</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;指定表在数据库中的名称&lt;/font&gt;&lt;/u&gt;，默认是实体的类名</li>
<li><strong>indexes</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;定义跨越多列的索引&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>createInDb</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;标记greenDAO是否创建数据库表，默认为true&lt;/font&gt;&lt;/u&gt;。如果有多个实体映射到同一个表，或者表在greenDAO外面创建了，可以设置为false</li>
</ol>
<h2>基本属性注解</h2>
<ol>
<li><strong>@Id</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;选择一个long/Long类型的属性作为实体ID&lt;/font&gt;&lt;/u&gt;。在数据库里，它是<code>主键（PK）</code>。参数<code>autoincrement</code>是一个让ID值增加的标记（不重用旧值）</li>
<li><strong>@Property</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;定义一个属性映射的非默认的列名&lt;/font&gt;&lt;/u&gt;，如果如果不指定，greenDAO默认以SQL-ish的形式使用域名，即大写、下划线代替驼峰，如customName会变成CUSTOM_NAME</li>
<li><strong>@NotNull</strong>：让属性在数据库里成为一个<code>“NOT NULL”</code>列</li>
<li><strong>@Transient</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;让属性不被存入持久层</li>
</ol>
<h2>索引注解</h2>
<ol>
<li><strong>@Index</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;为一个数据库列创建一个数据库索引&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<ul>
<li><strong>name</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;如果不喜欢greenDAO生成的默认索引名，可以通过该字段指定&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>unique</strong>：为该索引添加一个<code>UNIQUE</code>限制，强制所有值是唯一的</li>
</ul>
<ol start="2">
<li><strong>@Unique</strong>：为一个数据库列添加一个<code>UNIQUE</code>限制。注意SQLite也默认创建了一个索引</li>
</ol>
<h2>关联注解</h2>
<ol>
<li><strong>@ToOne</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;定义与另一个实体的关联，应用该注解到有另一个实体对象的属性上&lt;/font&gt;&lt;/u&gt;。在内部，greenDAO需要一个额外的指向目标实体的属性，通过<code>joinProperty</code>参数来指定。如果没有该参数，一个额外的列会被自动创建并拥有此<code>KEY</code></li>
<li><strong>@ToMany</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;定义与多个实体的关联，应用该注解到一组目标实体的属性上&lt;/font&gt;&lt;/u&gt;。目标实体必须有一个或多个指向源Entity的属性。有三种可能（只能使用其中一种）指定关联的映射</li>
</ol>
<ul>
<li><strong>referencedJoinProperty</strong>：指向目标Entity的ID的<code>外键（FK）</code>属性名</li>
<li><strong>joinProperties</strong>：为了更多复杂的关联，可以指定一组<code>@JoinProperty</code>注解。每个@JoinProperty需要一个源Entity的属性和目标Entity的属性</li>
</ul>
<ol start="3">
<li><strong>@JoinEntity</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;如果一个多对多的关联有另一个entity/table，可以在该属性上添加该注解&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h2>@Generated</h2>
<p>在greenDAO 3中Entity类由开发者创建和编辑，在代码生成过程中，greenDAO会增加实体的源码，同时会添加<code>@Generated</code>注解到生成的方法和域上来提示开发者，为了阻止任何代码的丢失。&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在大多数情况下，开发者不应该接触带有@Generated注解的代码&lt;/font&gt;&lt;/u&gt;。作为预防措施，greenDAO不会重写存在的代码，如果生成的代码被手动修改了，greenDAO会报错。</p>
<h1>使用</h1>
<h2>编写Entity类</h2>
<blockquote>
<p><strong>App.java</strong></p>
</blockquote>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span>(nameInDb = <span class="string">"app"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@Id</span></div><div class="line">  <span class="keyword">private</span> Long id;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String appUuid;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String iconUrl;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">int</span> type;</div><div class="line">  …</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>City.java</strong></p>
</blockquote>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span>(nameInDb = <span class="string">"city"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">City</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String code;</div><div class="line"></div><div class="line">  <span class="meta">@Id</span></div><div class="line">  <span class="keyword">private</span> Long id;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>JoinCityToApp.java</strong></p>
</blockquote>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JoinCityToApp</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@Id</span></div><div class="line">  <span class="keyword">private</span> Long id;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> Long cityId;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> Long appId;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>CityInfo.java</strong></p>
</blockquote>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span>(nameInDb = <span class="string">"city_info"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CityInfo</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@Id</span></div><div class="line">  <span class="keyword">private</span> Long id;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">  <span class="meta">@NotNull</span></div><div class="line">  <span class="keyword">private</span> String code;</div><div class="line"></div><div class="line">  <span class="meta">@ToMany</span></div><div class="line">  <span class="meta">@JoinEntity</span>(</div><div class="line">      entity = JoinCityToApp.class,</div><div class="line">      sourceProperty = <span class="string">"cityId"</span>,</div><div class="line">      targetProperty = <span class="string">"appId"</span></div><div class="line">  )</div><div class="line">  <span class="keyword">private</span> List&lt;App&gt; appList;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2>增删改查操作</h2>
<h3>初始化数据库</h3>
<p>获取<code>DaoMaster.DevOpenHelper</code>的实例即可</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DaoMaster.DevOpenHelper mHelper = <span class="keyword">new</span> DaoMaster.DevOpenHelper(context, DB_NAME);</div></pre></td></tr></table></figure></p>
<h3>增加操作</h3>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCityInfo</span><span class="params">(CityInfo info, List&lt;App&gt; appList, List&lt;Banner&gt; bannerList)</span> </span>&#123;</div><div class="line">  DaoSession daoSession = <span class="keyword">new</span> DaoMaster(getWritableDatabase()).newSession();</div><div class="line">  <span class="keyword">long</span> infoId = daoSession.insert(info);</div><div class="line">  JoinCityToApp joinCityToApp = <span class="keyword">null</span>;</div><div class="line">  <span class="keyword">for</span> (App app : appList) &#123;</div><div class="line">    <span class="keyword">long</span> appId = daoSession.insert(app);</div><div class="line">    joinCityToApp = <span class="keyword">new</span> JoinCityToApp(<span class="keyword">null</span>, infoId, appId);</div><div class="line">    daoSession.insert(joinCityToApp);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  JoinCityToBanner joinCityToBanner = <span class="keyword">null</span>;</div><div class="line">  <span class="keyword">for</span> (Banner banner : bannerList) &#123;</div><div class="line">    <span class="keyword">long</span> bannerId = daoSession.insert(banner);</div><div class="line">    daoSession.insert(banner);</div><div class="line">    joinCityToBanner = <span class="keyword">new</span> JoinCityToBanner(<span class="keyword">null</span>, infoId, bannerId);</div><div class="line">    daoSession.insert(joinCityToBanner);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3>查询操作</h3>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;App&gt; <span class="title">queryAppList</span><span class="params">(String code)</span> </span>&#123;</div><div class="line">  List&lt;App&gt; list = <span class="keyword">null</span>;</div><div class="line">  DaoSession daoSession = <span class="keyword">new</span> DaoMaster(getWritableDatabase()).newSession();</div><div class="line">  Query query = daoSession.getCityInfoDao().queryBuilder()</div><div class="line">      .where(CityInfoDao.Properties.Code.eq(code))</div><div class="line">      .build();</div><div class="line"></div><div class="line">  List&lt;CityInfo&gt; infoList = query.list();</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">null</span> != infoList &amp;&amp; infoList.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">    list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span> (CityInfo info : infoList) &#123;</div><div class="line">      list.addAll(info.getAppList());</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> list;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>参考方案</h1>
<ol>
<li><a href="http://greenrobot.org/greendao/documentation/updating-to-greendao-3-and-annotations/" target="_blank" rel="external"><strong>Updating to greenDAO 3 and annotations</strong></a></li>
<li><a href="https://github.com/greenrobot/greenDAO" target="_blank" rel="external"><strong>greenrobot/greenDAO</strong></a></li>
<li><a href="http://blog.csdn.net/njweiyukun/article/details/51893092" target="_blank" rel="external"><strong>【greenDAO 3】项目搭建与增删该查操作</strong></a></li>
<li><a href="http://greenrobot.org/greendao/features/" target="_blank" rel="external"><strong>greenDAO Features</strong></a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/15/Retrofit 2.0使用总结/" itemprop="url">
                  Retrofit 2.0使用总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-15T00:02:47+08:00" content="2016-07-15">
              2016-07-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/http/" itemprop="url" rel="index">
                    <span itemprop="name">http</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/http/retrofit/" itemprop="url" rel="index">
                    <span itemprop="name">retrofit</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/15/Retrofit 2.0使用总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/15/Retrofit 2.0使用总结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概述</h1>
<p>本文主要介绍<code>Retrofit 2.0</code>的基础知识</p>
<h1>基础</h1>
<h2>基本介绍</h2>
<ol>
<li><code>Retrofit</code>是由<code>Square</code>开发的一个Android和Java的<code>REST</code>库，可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;利用接口、方法和注解参数&lt;/font&gt;&lt;/u&gt;来声明式定义一个请求应该如何被创建</li>
<li>Retrofit背后的<code>HTTP client</code>、序列化机制（<code>JSON/XML协议</code>）都是可替换（<code>pluggable</code>）的，使用者可以选择适合自己的方案</li>
<li>请求的发送实现分<strong>同步</strong>和<strong>异步</strong>两种</li>
<li>支持<code>RxJava</code></li>
<li>Retrofit 1不够好：</li>
</ol>
<ul>
<li>为了支持可替换的功能模块，必须嵌套大量的组件，类的数量极多</li>
<li>如果想要操作某次请求返回的数据，如返回的<code>Header</code>部分或<code>URL</code>，又同时想要操作序列化后的数据部分，这些在Retrofit 1.0上是不可能实现</li>
<li>在同步、异步和RxJava的使用上比较刻板，不够灵活，如异步和同步的调用必须得分别声明两次方法</li>
<li>Retrofit 1里<code>Converter</code>工作的效率不高，如传入了<code>Response</code>和想要转换的格式<code>Type</code>参数后，Converter必须得搞清楚到底应该如何去反序列化，这部分的实现很复杂，而且耗时</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>配置</h2>
<p>在根模块的<code>build.gradle</code>文件的<code>dependencies</code>块中添加</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.squareup.retrofit2:retrofit:2.0.0-beta4'</span></div></pre></td></tr></table></figure></p>
<h2>API接口</h2>
<h3>定义形式</h3>
<p>在Retrofit 2.0中，创建Service更简单了，因为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;只需定义一种形式&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">APIService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@POST</span>(<span class="string">"/list"</span>)</div><div class="line">    <span class="function">Call&lt;Repo&gt; <span class="title">loadRepo</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3>Call类型</h3>
<p>Retrofit 2.0使用新的类型<code>Call</code>来用于OkHttp的API请求，另外，每一个call对象实例只能被用一次，即<code>request</code>和<code>response</code>是一一对应，可以通过<code>clone</code>方法来创建一个一模一样的实例</p>
<h3>同步 &amp; 异步</h3>
<p>Retrofit 2.0支持在同一个类型中的<strong>同步</strong>和<strong>异步</strong>，同时&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个请求也可以被终止&lt;/font&gt;&lt;/u&gt;</p>
<ol>
<li><strong>同步</strong></li>
</ol>
<ul>
<li>调用<code>execute</code>方法执行同步请求</li>
<li>不能在Android主线程（<code>Main Thread</code>）中直接使用，因为会堵塞线程，否则会报错（<code>NetworkOnMainThreadException</code>）</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Call&lt;Repo&gt; call = service.loadRepo();</div><div class="line">Repo repo = call.execute();</div></pre></td></tr></table></figure></p>
<ol start="2">
<li><strong>异步</strong></li>
</ol>
<ul>
<li>调用<code>enqueue</code>方法执行异步请求</li>
<li><code>onResponse</code>和<code>onFailure</code>方法会在主线程（<code>Main Thread</code>）中被调用</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Call&lt;Repo&gt; call = service.loadRepo();</div><div class="line">call.enqueue(<span class="keyword">new</span> Callback&lt;Repo&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Response&lt;Repo&gt; response)</span> </span>&#123;</div><div class="line">        <span class="comment">// Get result Repo from response.body()</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Throwable t)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<ol start="3">
<li><strong>取消请求</strong>：可以随时调用<code>cancel</code>方法来取消请求</li>
</ol>
<h3>Response类型</h3>
<ol>
<li>Retrofit 2.0中使用了参数化的<code>Response</code>类型，Response对象增加了一些重要元数据：响应码（<code>the response code</code>）、响应消息（<code>the response message</code>）、响应头（<code>headers</code>）等</li>
<li>Response类型提供了一系列函数，如<code>code</code>用来判断请求是否成功完成，<code>body</code>用来获取响应体等</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;只有响应成功后，才会去做反序列化操作，然后将反序列化的结果放到body回调中&lt;/font&gt;&lt;/u&gt;</li>
<li>具体的<code>ResponseBody</code>（简单封装了的content-type、length、raw body等部分）由开发者处理</li>
</ol>
<h3>动态URL参数</h3>
<ol>
<li>Retrofit 2.0使用新的标注<code>@Url</code>来允许&lt;u&gt;&lt;font color=&quot;red&quot;&gt;直接传入一个请求的URL&lt;/font&gt;&lt;/u&gt;</li>
<li>请求的服务器可能将<code>header link</code>地址列表里的数据已经缓存在服务器内存里，可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;直接根据该地址去请求，然后毫不费劲地从数据库里拿数据，速度上也更快&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h2>API接口实现</h2>
<h3>Converter</h3>
<ol>
<li>Retrofit 2.0中，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;Converter不再包含在包里了，开发者需要自己插入一个Converter，否则Retrofit只能接收到字符串的结果&lt;/font&gt;&lt;/u&gt;</li>
<li>Retrofit 2.0&lt;u&gt;&lt;font color=&quot;red&quot;&gt;支持多个Converter&lt;/font&gt;&lt;/u&gt;</li>
<li>可以自定义实现<code>Converter.Factory</code>接口</li>
</ol>
<table>
<thead>
<tr>
<th>Converter</th>
<th>Dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gson</td>
<td>com.squareup.retrofit:converter-gson</td>
</tr>
<tr>
<td>Jackson</td>
<td>com.squareup.retrofit:converter-jackson</td>
</tr>
<tr>
<td>Moshi</td>
<td>com.squareup.retrofit:converter-moshi</td>
</tr>
<tr>
<td>Protobuf</td>
<td>com.squareup.retrofit:converter-protobuf</td>
</tr>
<tr>
<td>Wire</td>
<td>com.squareup.retrofit:converter-wire</td>
</tr>
<tr>
<td>Simple XML</td>
<td>com.squareup.retrofit:converter-simplexml</td>
</tr>
</tbody>
</table>
<h3>新的URL定义形式</h3>
<ol>
<li><strong>Base URL</strong>：总是以<code>/</code>结束</li>
<li><strong>@Url</strong>：不要以/开始；Retrofit 2.0中可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在@Url中定义一个完全的URL&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h3>请求方法</h3>
<p>Retrofit的<code>HTTP</code>注解用来&lt;u&gt;&lt;font color=&quot;red&quot;&gt;修饰请求方法&lt;/font&gt;&lt;/u&gt;</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>请求指定url的数据,请求体为空(例如打开网页)。</td>
</tr>
<tr>
<td>POST</td>
<td>请求指定url的数据，同时传递参数(在请求体中)。</td>
</tr>
<tr>
<td>HEAD</td>
<td>类似于get请求，只不过返回的响应体为空，用于获取响应头。</td>
</tr>
<tr>
<td>PUT</td>
<td>从客户端向服务器传送的数据取代指定的文档的内容。</td>
</tr>
<tr>
<td>DELETE</td>
<td>请求服务器删除指定的页面。</td>
</tr>
<tr>
<td>CONNECT</td>
<td>HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。</td>
</tr>
<tr>
<td>OPTIONS</td>
<td>允许客户端查看服务器的性能。</td>
</tr>
<tr>
<td>TRACE</td>
<td>回显服务器收到的请求，主要用于测试或诊断。</td>
</tr>
</tbody>
</table>
<h3>URL MANIPULATION</h3>
<ol>
<li><strong>@Path</strong>：一个请求的URL可以使用方法上的<strong>替换块</strong>和<strong>参数</strong>来动态更新。一个替换块是由<code>{</code>和<code>}</code>包围，一个适合的参数必须使用同一字符串的<code>@Path</code>来注解</li>
<li><strong>@Query</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;添加查询参数&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>@QueryMap</strong>：若有多个查询参数时，可以放在<code>Map</code>中</li>
</ol>
<h3>REQUEST BODY</h3>
<p>一个对象可以使用<code>@Body</code>注解被用作一个HTTP请求体。该对象也会通过使用在Retrofit实例中指定的转换器来转换，如果没有提添加转换器，默认使用<code>RequestBody</code></p>
<h3>FORM ENCODED AND MULTIPART</h3>
<p>用于<strong>方法</strong>上</p>
<ol>
<li><strong>@FormUrlEncoded</strong>：发送表单数据，每个键值对使用带名称和提供的值的<code>@Field</code>注解</li>
<li><strong>@Multipart</strong>：在方法上使用<code>@Multipart</code>注解，对每个part使用<code>@Part</code>注解，其中parts可以使用Retorfit的转换器或实现<code>RequestBody</code>来处理序列化</li>
</ol>
<h3>HEADER MANIPULATION</h3>
<p>使用<code>@Headers</code>注解来为一个方法设置静态的头部</p>
<ol>
<li>头部不能复写，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;拥有同一名字的所有头部会被包含在请求中&lt;/font&gt;&lt;/u&gt;</li>
<li>请求头可以使用<code>@Header</code>注解来动态更新，如果该值为null，该头部会被忽略</li>
<li>需要被添加到每个请求的头部可以使用<code>OkHttp Interceptor</code>来指定</li>
</ol>
<h2>OkHttp</h2>
<ol>
<li>Retrofit 2.0中需要<code>OkHttp</code>库，并且被自动设置为依赖库</li>
<li>Retrofit 2.0中无论响应是否能被解析，<code>onResponse</code>总会被调用，万一返回的结果不能被解析为对象，<code>response.body()</code>会返回<code>null</code>，注意不要忘记处理此情况</li>
<li>Retrofit 2.0中如果忘记添加<code>INTERNET</code>权限，会立即抛出<code>SecurityException</code>，如果没有处理<code>try-catch</code>的话，会引起应用崩溃</li>
<li>Retrofit 2.0中需要创建一个带<code>Interceptor</code>的OkHttpClient，然后作为参数放入Retrofit的<code>Builder</code>链中</li>
</ol>
<h2>RxJava</h2>
<ol>
<li>
<p>Retrofit 2.0中除了定义<code>Call&lt;T&gt;</code>形式的接口，也可以定义自己的类型，该机制称为<code>CallAdapter</code></p>
</li>
<li>
<p>RxJava作为一种非常流行的CallAdapter，返回的类型为<code>Observable&lt;T&gt;</code></p>
</li>
<li>
<p>RxJava需要在根模块的<code>build.gradle</code>文件中使用如下依赖
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.squareup.retrofit:adapter-rxjava:2.0.0-beta2'</span></div><div class="line">compile <span class="string">'io.reactivex:rxandroid:1.0.1'</span></div></pre></td></tr></table></figure></p>
</li>
<li>
<p>在Retrofit的Builder链中作为<code>addCallAdapterFactory</code>的参数</p>
</li>
<li>
<p>API接口的方法返回对象是Observable&lt;T&gt;类型</p>
</li>
<li>
<p>必须让代码在主线程中被调用，即<code>observeOn(AndroidSchedulers.mainThread())</code>方法</p>
</li>
</ol>
<h1>参考方案</h1>
<ol>
<li><a href="https://realm.io/cn/news/droidcon-jake-wharton-simple-http-retrofit-2/" target="_blank" rel="external"><strong>用Retrofit 2简化HTTP请求</strong></a></li>
<li><a href="http://square.github.io/retrofit/" target="_blank" rel="external"><strong>Retrofit-A type-safe HTTP client for Android and Java</strong></a></li>
<li><a href="https://inthecheesefactory.com/blog/retrofit-2.0/en" target="_blank" rel="external"><strong>Retrofit 2.0: The biggest update yet on the best HTTP Client Library for Android</strong></a></li>
<li><a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/1016/3588.html" target="_blank" rel="external"><strong>使用Retrofit请求API数据－codepath教程</strong></a></li>
<li><a href="http://www.jianshu.com/p/63723f593695" target="_blank" rel="external"><strong>Retrofit-网络请求库</strong></a></li>
<li><a href="http://blog.csdn.net/sk719887916/article/details/51755427" target="_blank" rel="external"><strong>Retrofit 2.0超能实践（三），轻松实现文件/图片上传</strong></a></li>
<li><a href="http://blog.csdn.net/sk719887916/article/details/51700659" target="_blank" rel="external"><strong>Retrofit2.0完美同步Cookie实现免登录</strong></a></li>
<li><a href="http://blog.csdn.net/sk719887916/article/details/51597816" target="_blank" rel="external"><strong>Retrofit 2.0超能实践，完美支持Https传输</strong></a></li>
<li><a href="http://www.jianshu.com/p/3141d4e46240" target="_blank" rel="external"><strong>Android网络请求心路历程</strong></a></li>
<li><a href="http://www.jianshu.com/p/af38d9741655" target="_blank" rel="external"><strong>Retrofit的分析以及实现步骤</strong></a></li>
<li><a href="http://www.tuicool.com/articles/aiyma2u" target="_blank" rel="external"><strong>Retrofit分析-漂亮的解耦套路</strong></a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/05/Java-Annotation/" itemprop="url">
                  Java Annotation
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-05T11:46:19+08:00" content="2016-07-05">
              2016-07-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/annotation/" itemprop="url" rel="index">
                    <span itemprop="name">annotation</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/05/Java-Annotation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/05/Java-Annotation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍Java注解（&lt;u&gt;&lt;font color=&quot;red&quot;&gt;Java Annotation&lt;/font&gt;&lt;/u&gt;）的概念、类型及使用等知识。</p>
<h1>概念</h1>
<h2>基本知识</h2>
<ul>
<li>Java编程语言里，Java注解是一种可以被添加到Java源码里的元数据（<code>metadata</code>），尽管它们不是程序的一部分</li>
<li>类（<code>Classes</code>）、方法（<code>methods</code>）、变量（<code>variables</code>）、参数（<code>parameters</code>）和包（<code>packages</code>）都可以被注解</li>
<li>Java注解从&lt;u&gt;&lt;font color=&quot;red&quot;&gt;JDK 1.5&lt;/font&gt;&lt;/u&gt;开始被加入到Java中</li>
<li>Java注解对程序的执行没有影响</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>注解形式</h2>
<ol>
<li>使用<code>@</code>来告诉编译器，如<code>@Entity</code>告诉编译器注解的名字是Entity</li>
<li>注解可以包含元素</li>
</ol>
<ul>
<li>
<p>这些元素对名称没有要求，可以有值，如
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Author</span> &#123;</div><div class="line">  name = <span class="string">"Benjamin Franklin"</span></div><div class="line">  data = <span class="string">"3/27/2003"</span></div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>如果只有一个带值的元素，其名称可以被忽略，如
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@SuppressWarning</span>(<span class="string">"unchecked"</span>)</div><div class="line"><span class="function">voido <span class="title">myMethod</span><span class="params">()</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>如果没有元素，圆括号可以去掉，如<code>@Override</code></p>
</li>
</ul>
<ol start="3">
<li>
<p>在同一定义上也可以使用多个注解，如
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Author</span>(name=<span class="string">"Jane Doe"</span>)</div><div class="line"><span class="meta">@EBook</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>如果注解有同一类型，则被称为重复注解（<code>repeating annotation</code>）</p>
</li>
</ol>
<h1>类型</h1>
<p>许多注解类型在<code>Java SE API</code>里预定义，一些注解类型用于Java编译器，一些应用到其它注解</p>
<h2>应用到Java代码的注解</h2>
<p>也称为内置注解（<code>Built-in Annotations</code>）</p>
<ol>
<li>
<p><code>@Override</code>：告知编译器该元素是为了覆盖定义在父类的元素，如果一个方法在父类或被实现接口中没有被发现，会引起编译器报错。如当覆盖子类的一个方法时，应该使用<code>@Override</code>来标记该方法，这样可以让代码可读，并且避免维护问题，例如当修改父类的方法签名时，开发人员必须修改子类中该方法的签名，否则编译器会抛出编译错误。当没有使用<code>@Override</code>时，会很难追踪到错误位置。见下面例子
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyParentClass</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">justMethod</span><span class="params">()</span> </span>&#123;...&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyChildClass</span> <span class="keyword">extends</span> <span class="title">MyParentClass</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">justMethod</span><span class="params">()</span> </span>&#123;...&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><code>@Deprecated</code>：提示标记的元素（类、方法或域）过时了，应该不再使用。无论何时程序使用已经使用<code>@Deprecated</code>注解标记的方法、类或域时，编译器生成一个警告</p>
</li>
<li>
<p><code>@SuppressWarnings</code>：指示编译器忽略特殊的警告。如当在调用过时的方法（假定该方法使用<code>@Deprecated</code>标记）时，使用<code>@SuppressWarnings</code>注解来禁止派生的警告，如下代码所示
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><code>@SafeVarargs</code>：在<code>Java SE 7</code>中引入，当应用到方法或构造函数时，声称代码不对其可变参数（<code>varargs</code>）的参数进行潜在的不安全操作。当该注解类型被使用时，关联到可变参数的<code>unchecked</code>警告被禁止</p>
</li>
<li>
<p><code>@FunctionalInterface</code>：在<code>Java SE 8</code>中引入，表明此类型声明是一个功能性接口</p>
</li>
</ol>
<h2>应用到其它注解的注解</h2>
<p>也称为元注解（<code>Meta Annotations</code>）</p>
<ol>
<li><code>@Retention</code>：具体说明标记的注解如何被存储</li>
</ol>
<ul>
<li><strong>RetentionPolicy.SOURCE</strong>：保留在源码里，被编译器忽略</li>
<li><strong>RetentionPolicy.CLASS</strong>：被编译时的编译器保留，但被<code>JVM</code>忽略</li>
<li><strong>RetentionPolicy.RUNTIME</strong>：被<code>JVM</code>保留，可以在运行时环境被使用（通过反射）</li>
</ul>
<ol start="2">
<li><code>@Documented</code>：指明使用该注解的元素应该使用<code>javadoc</code>工具记录</li>
<li><code>@Target</code>：具体说明可以在何处使用该注解，如定义目标类型为<code>METHOD</code>，意味着该注解只能用在方法上</li>
</ol>
<ul>
<li><strong>ElementType.ANNOTATION_TYPE</strong>：用于注解类型</li>
<li><strong>ElementType.CONSTRUCTOR</strong>：用于构造函数</li>
<li><strong>ElementType.FIELD</strong>：用于域或属性</li>
<li><strong>ElementType.LOCAL_VARIABLE</strong>：用于局部变量</li>
<li><strong>ElementType.METHOD</strong>：用于方法</li>
<li><strong>ElementType.PACKAGE</strong>：用于包的定义</li>
<li><strong>ElementType.PARAMETER</strong>：用于方法的参数</li>
<li><strong>ElementType.TYPE</strong>：用于类的任意元素</li>
</ul>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</div><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyCustomAnnotation &#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  <span class="meta">@MyCustomAnnotation</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myMethod</span><span class="params">()</span> </span>&#123; <span class="comment">// do sth &#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol start="4">
<li>
<p><code>@Inherited</code>：指明在一个类里被使用的自定义注解应该被所有的子类继承，如下所示
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Inherited</span></div><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyCustomAnnotation &#123;&#125;</div><div class="line"></div><div class="line"><span class="meta">@MyCustomAnnotation</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyParentClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyChildClass</span> <span class="keyword">extends</span> <span class="title">MyParentClass</span> </span>&#123;&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><code>@Repeatable</code>：在Java SE 8中引入，具体指明该注解可以用于同一定义多次，如下所示
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Author</span>(name=<span class="string">"Jane Doe"</span>)</div><div class="line"><span class="meta">@Author</span>(name=<span class="string">"John Smith"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;...&#125;</div></pre></td></tr></table></figure></p>
</li>
</ol>
<h1>使用</h1>
<ol>
<li><strong>编译器信息</strong>：<code>Information for the compiler</code>，被编译器用来检测错误或禁止警告；在Java中有三个内置的可用的注解（<code>@Deprecated</code>，<code>@Override</code>和<code>@SupressWarning</code>），能被用来提供某种指示给编译器</li>
<li><strong>编译时和部署时处理</strong>：<code>Compile-time and deployment-time processing</code>，软件工具可以处理注解信息来生成代码、XML文件等等</li>
<li><strong>运行时处理</strong>：<code>Runtime processing</code>，一些注解可用于在运行时被检测</li>
</ol>
<h1>参考方案</h1>
<ol>
<li><a href="http://beginnersbook.com/2014/09/java-annotations/" target="_blank" rel="external"><strong>Java annotations tutorial with examples</strong></a></li>
<li><a href="https://en.wikipedia.org/wiki/Java_annotation" target="_blank" rel="external"><strong>Java annotation</strong></a></li>
<li><strong>Java官方文档</strong></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/22/svn教程/" itemprop="url">
                  svn教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-22T00:36:16+08:00" content="2016-06-22">
              2016-06-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/tool/" itemprop="url" rel="index">
                    <span itemprop="name">tool</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/tool/svn/" itemprop="url" rel="index">
                    <span itemprop="name">svn</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/22/svn教程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/22/svn教程/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍svn的使用，转载自<strong>svn使用教程总结</strong>&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;。</p>
<h1>SVN简介</h1>
<p><code>Subversion</code>的简称，是一个&lt;u&gt;&lt;font color=&quot;red&quot;&gt;自由/开源的版本控制系统&lt;/font&gt;&lt;/u&gt;，一组文件存放在中心版本库，记录每一次文件和目录的修改，Subversion允许把数据恢复到早期版本，或是检查数据修改的历史，Subversion可以通过网络访问它的版本库，从而使用户在不同的电脑上进行操作。</p>
<p>&lt;!-- more --&gt;</p>
<h1>SVN服务器搭建和使用</h1>
<p>&lt;font color=&quot;red&quot;&gt;Note&lt;/font&gt;：下面操作在Windows环境下进行</p>
<h2>VisualSVN下载</h2>
<p>在<strong>VisualSVN</strong>&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;官网选择<code>VisualSVN Server</code>下载</p>
<h2>VisualSVN安装</h2>
<p>双击下载应用，选择标准版模式，并且设置好相关的配置，如版本库目录（<code>Repositories</code>）、端口（<code>Server Port</code>）、安全连接（勾选<code>Use secure connection</code>）等，一直到安装完成</p>
<h2>建立版本库</h2>
<p>打开应用，右键单击左边窗口的<code>Repositories</code>，选择<code>Create New Repository</code>，输入版本库名称后，最后会生成一个版本库URL（<code>Repository URL</code>）地址</p>
<h2>建立用户和组，并分配权限</h2>
<ul>
<li>在应用窗口左侧单击用户，选择<code>Create User</code>，要求填写<code>Username</code>和	<code>Password</code>，点击<code>OK</code>按钮后，再点击<code>Add</code>按钮即完成用户建立操作</li>
<li>在应用窗口左侧单击组，选择<code>Create Group</code>，要求填写<code>Group name</code>，点击<code>Add</code>按钮，在弹出窗口中选择该组，即加入到该组</li>
<li>在版本库上右键，选择<code>Properties...</code>，选择<code>Security</code>选项卡，点击<code>Add</code>按钮，选中某一用户添加进来，权限设置为<code>Read/Write</code>，即完成用户权限设置操作</li>
</ul>
<h1>TortoiseSVN客户端</h1>
<h2>下载</h2>
<p>在<strong>TortoiseSVN</strong>&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;官网选择适合当前系统位数的版本下载</p>
<h2>安装</h2>
<p>双击下载应用，安装完成后可以通过右键看到<code>TortoiseSVN</code>选项，即安装成功</p>
<h2>检出项目文件</h2>
<p>新建并进入目录下，右键选择<code>Svn Checkout</code>，然后将SVN服务器获取到的版本库地址填写到弹出窗口的<code>URL of repository</code>栏，点击<code>OK</code>按钮即可检索出来</p>
<p>&lt;font color=&quot;red&quot;&gt;Note&lt;/font&gt;：<code>.svn</code>这个隐藏目录记录着两项关键信息，即工作文件的基准版本和本地副本最后更新的时间戳，不要手动修改或更新该隐藏目录或里面的文件，否则将导致本地的工作拷贝被破坏，无法再进行操作</p>
<h2>基础操作</h2>
<h3>SVN检出（SVN Checkout）</h3>
<p>在文件夹或者目录下单击右键 –&gt; 选择SVN检出 -&gt; 在弹开窗口的版本库url框中输入版本库的目录地址 -&gt; 点击ok按钮 -&gt; 在弹出的对话框中输入用户名和密码，验证成功后，项目文件开始从远程服务器下载到本地工作目录中</p>
<h3>增加（Add）</h3>
<p>提交到版本库有两种方法</p>
<ol>
<li>先提到变更列表中，再commit到配置库中，选择新增文件，右键SVN菜单执行<code>Add</code>操作提交到变更列表中，然后右键SVN菜单执行<code>SVN Commit</code>提交到版本库中</li>
<li>不提交到变更列表中，而是直接commit配置库中，选择该文件，右键svn菜单执行<code>SVN Commit</code>操作</li>
</ol>
<h3>删除（Delete）</h3>
<ul>
<li>如果被删除的文件还未入版本库，则可以直接使用操作系统的删除操作删除该文件</li>
<li>如果被删除的文件已入版本库，选择被删除文件，右键svn菜单执行<code>delete</code>操作，然后选择被删除文件的父目录，右键svn菜单执行<code>SVN Commit</code>，使用操作系统的删除操作删除该文件，然后选择被删除文件的父目录，右键svn菜单执行<code>SVN Commit</code>,在变更列表中选择被删除的文件</li>
</ul>
<h3>改名（Rename）</h3>
<p>修改文件名，选中需要重命名的文件或文件夹，然后右键<code>TortoiseSVN Rename</code>，在弹出的对话框中输入新名称，点击”ok”按钮，并将修改文件名后的文件或文件夹通过<code>SVN Commit</code>提交到SVN服务器上</p>
<h3>SVN还原（SVN Revert）</h3>
<p>右击想要回退的文件或者文件夹，在TortoiseSVN弹出菜单中选择<code>Update to reversion…</code>，然后会弹出一个窗口，只需要在<code>Revision</code>中填写相应的版本号，然后点击ok即可</p>
<h3>检查更新（Check for modifications）</h3>
<p>此功能可以显示你所做的修改有哪些还没有提交的，此功能不光能看到对文件的修改变化，所有的变化都能看到，包括增加文件或者目录，删除文件或者目录，移动文件或者目录等，如果你点击了检查版本库，那你还可以看到版本库里的改动，既别人提交了哪些文件的改动，你还没更新到本地</p>
<h3>SVN更新（SVN Update）</h3>
<p>更新本地代码与SVN服务器上最新的版本一致，只要在需要更新的文件夹上点击右键或者在文件下空白处点击右键，选择<code>SVN Update</code>(获取指定版本中的内容，点击右键执行SVN菜单中的<code>Update to reversion</code>)</p>
<h3>SVN提交（SVN Commit）</h3>
<p>SVN的提交是将在工作空间做的修改进行提交，包括文件内容的修改，文件或目录的添加、删除、命名、移动等操作</p>
<h3>显示日志（Show log）</h3>
<p>通过此功能可以查到谁，什么时候，对那个目录下的那些文件进行了那些操作</p>
<h3>版本库浏览（Repo-browser）</h3>
<p>此功能是用来浏览需要查看的资料库，在本地文件夹下点击右键，选择<code>TortoiseSVN Repo-browser</code>，在弹出的对话框中输入资料库地址，再输入用户名和密码，就能查看到你需要查看到版本库的内容，在这你还能看到那些文件被谁锁定了</p>
<h2>创建分支合并相互操作</h2>
<h3>提取主干上的代码</h3>
<p>点击trunk -&gt; 右键SVN Checkout -&gt; 弹出对话框中输入版本库URL -&gt; 点击OK按钮可以在主干上把代码从远程服务器上获取到</p>
<h3>新建分支</h3>
<p>右键trunk -&gt; 选择Branch/Tag -&gt; 指明新分支的路径 -&gt; 点击OK按钮可以在VisualSVN Server上新增分支</p>
<h3>合并分支到主干上</h3>
<p>右键trunk -&gt; 选择TortoiseSVN -&gt; Merge -&gt; 弹出窗口中选择Merge two different trees -&gt; 分别输入主干上和分支下的URL地址 -&gt; 点击Merge按钮</p>
<h3>合并主干到分支</h3>
<p>右键分支 -&gt; 选择TortoiseSVN -&gt; Merge -&gt; 弹出窗口中选择Merge two different trees -&gt; 分别输入分支上和主干下的URL地址 -&gt; 点击Merge按钮</p>
<h1>参考方案</h1>
<ol>
<li><a href="http://baike.baidu.com/link?url=iOg5lAwH_XWoGyx8X9F12EKaaFoZOG8BrtyWSijvOUIT-odx8dJKubqMWOfuXvD06Q8YBAi3vYhVw38www2ena" target="_blank" rel="external"><strong>SVN百度百科</strong></a></li>
</ol>
<p>&lt;div id=&quot;footnotes&quot;&gt;&lt;hr&gt;&lt;div id=&quot;footnotelist&quot;&gt;&lt;ol style=&quot;list-style:none; padding-left: 0;&quot;&gt;&lt;li id=&quot;fn:1&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;1.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/armyfai/p/3985660.html&quot;&gt;&lt;strong&gt;svn使用教程总结&lt;/strong&gt;&lt;/a&gt;&lt;/span&gt;&lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;fn:2&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;2.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;&lt;a href=&quot;https://www.visualsvn.com/downloads/&quot;&gt;&lt;strong&gt;VisualSVN下载地址&lt;/strong&gt;&lt;/a&gt;&lt;/span&gt;&lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;fn:3&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;3.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;&lt;a href=&quot;https://tortoisesvn.net/downloads.html&quot;&gt;&lt;strong&gt;TortoiseSVN下载地址&lt;/strong&gt;&lt;/a&gt;&lt;/span&gt;&lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/20/Java数据存储/" itemprop="url">
                  Java数据存储
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-20T22:59:02+08:00" content="2016-06-20">
              2016-06-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/memory/" itemprop="url" rel="index">
                    <span itemprop="name">memory</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/20/Java数据存储/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/20/Java数据存储/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍Java中数据的存储位置及机制。</p>
<h1>概念</h1>
<p>在Java中，程序分为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;6个存储区域&lt;/font&gt;&lt;/u&gt;来存放变量以及代码占用的内存</p>
<p>&lt;!-- more --&gt;</p>
<ol>
<li><strong>寄存器</strong>：<code>Register</code>，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;最快的存储区，位于CPU内部，程序无法控制&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>栈</strong>：<code>Stack</code>
<ul>
<li>位于通用<code>RAM</code>中，通过<strong>栈指针</strong>可以从处理器那里直接获得</li>
<li>栈指针若&lt;u&gt;&lt;font color=&quot;red&quot;&gt;向下移动则分配新的内存&lt;/font&gt;&lt;/u&gt;，若&lt;u&gt;&lt;font color=&quot;red&quot;&gt;向上移动则释放内存&lt;/font&gt;&lt;/u&gt;</li>
<li>一种快速的分配方法，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;仅次于寄存器&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;基本类型的数据&lt;/font&gt;&lt;/u&gt;和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;对象&lt;/font&gt;&lt;/u&gt;的引用</li>
</ul>
</li>
<li><strong>堆</strong>：<code>Heap</code></li>
</ol>
<ul>
<li>存放由<code>new</code>创建的对象和数组</li>
<li>由<code>JVM</code>自动管理</li>
</ul>
<ol start="4">
<li><strong>静态存储区域</strong>：<code>Static Field</code></li>
</ol>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在固定的位置存放应用程序运行时一直存在的数据&lt;/font&gt;&lt;/u&gt;</li>
<li>生命周期&lt;u&gt;&lt;font color=&quot;red&quot;&gt;随着程序编译而产生，程序结束而回收&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<ol start="5">
<li><strong>常量池</strong>：<code>Constant Pool</code></li>
</ol>
<ul>
<li><code>JVM</code>虚拟机必须&lt;u&gt;&lt;font color=&quot;red&quot;&gt;为每个被装载的类型维护一个常量池&lt;/font&gt;&lt;/u&gt;</li>
<li>常量池是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;该类型所用到常量的一个有序集合&lt;/font&gt;&lt;/u&gt;，包括直接常量（基本类型，<code>String</code>）和其它类型、字段和方法的符号引用</li>
</ul>
<ol start="6">
<li><strong>非RAM存储区</strong>：数据&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存活于程序之外，不受程序控制&lt;/font&gt;&lt;/u&gt;，在没有程序的时候依然存在。如<strong>流对象</strong>和<strong>持久化对象</strong></li>
</ol>
<h1>堆内存存储与栈内存存储比较</h1>
<h2>存储方式</h2>
<h3>相同点</h3>
<p>堆与栈都是用于程序中的数据在<code>RAM</code>（内存）上的存储区域，并且<code>Java</code>会&lt;u&gt;&lt;font color=&quot;red&quot;&gt;自动地管理堆和栈，不能人为去直接设置&lt;/font&gt;&lt;/u&gt;</p>
<h3>不同点</h3>
<ol>
<li><strong>存储数据类型</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;栈内存中存放局部变量（基本数据类型和对象引用）&lt;/font&gt;&lt;/u&gt;，而&lt;u&gt;&lt;font color=&quot;red&quot;&gt;堆内存用于存放对象（实体）&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>存储速度</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;栈内存的存储分配与清理速度更快于堆&lt;/font&gt;&lt;/u&gt;，并且栈内存的存储速度仅次于直接位于处理器中的寄存器</li>
<li><strong>灵活性</strong>：由于栈内存与堆内存存储机制的不同，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;堆内存灵活性更优于栈内存&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h2>存储机制</h2>
<ul>
<li>栈内存被要求&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存放在其中的数据的大小、生命周期必须是已经确定的&lt;/font&gt;&lt;/u&gt;</li>
<li>堆内存可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;被虚拟机动态的分配内存大小，无需事先知道编译器的数据的大小、生命周期等相关信息&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>存储数据类型</h2>
<h3>栈内存</h3>
<ul>
<li>在<code>Java</code>中，变量的类型通常分为<strong>基本数据类型变量</strong>和<strong>对象引用变量</strong></li>
<li>8种基本数据类型实际上&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存储的是一组位数不同的二进制数据&lt;/font&gt;&lt;/u&gt;，除此之外，布尔型只有<code>true</code>和<code>false</code>两种值</li>
<li>对象引用变量&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存储的实际是其所关联（指向）对象在内存中的内存地址，而内存地址实际上也是一串二进制的数据&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;局部变量的大小可以确定，会在其自身所属方法（或代码块）执行完毕后，被自动释放&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h3>堆内存</h3>
<ul>
<li><code>Java</code>中使用关键字<code>new</code>通过调用类的构造函数，从而得到该类的对象</li>
<li>对象类型数据&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在程序编译期并不会在内存中进行创建和存储工作&lt;/font&gt;&lt;/u&gt;，而是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在程序运行期才根据需要进行动态的创建和存储&lt;/font&gt;&lt;/u&gt;</li>
<li>对象&lt;u&gt;&lt;font color=&quot;red&quot;&gt;由堆内存进行存储管理&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>栈内存中存储的数据可以实现数据共享</h2>
<ul>
<li><strong>好处</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;节约内存空间&lt;/font&gt;&lt;/u&gt;，避免反复向内存中加入同样的值</li>
<li>对于字符串而言，如果是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;编译器已经创建好&lt;/font&gt;&lt;/u&gt;（直接使用双引号定义）的就&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存储在常量池中&lt;/font&gt;&lt;/u&gt;，如果是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;运行期&lt;/font&gt;&lt;/u&gt;（<code>new</code>出来的）才能确定&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存储在堆中&lt;/font&gt;&lt;/u&gt;</li>
<li>对于<code>equals()</code>相等的字符串，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在常量池中永远只有一份，在堆中可以有多份&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;常量池与栈内存一样，也可以实现数据共享&lt;/font&gt;&lt;/u&gt;</li>
<li>成员变量的数据&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存储于堆中该成员变量所属的对象里&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;堆内存中存放的变量会进行默认初始化&lt;/font&gt;&lt;/u&gt;，而&lt;u&gt;&lt;font color=&quot;red&quot;&gt;栈内存中存放的变量却不会&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h1>参考方案</h1>
<ol>
<li><a href="http://blog.csdn.net/ghost_programmer/article/details/40891735" target="_blank" rel="external"><strong>java中数据的5种存储位置（堆与栈）</strong></a></li>
<li><a href="http://blog.csdn.net/woshimalingyi/article/details/44495497" target="_blank" rel="external"><strong>Java中数据存储方式、栈机制与引用的关系</strong></a></li>
<li><a href="http://item.jd.com/11758334.html?cu=true&amp;utm_source=baidu-search&amp;utm_medium=cpc&amp;utm_campaign=t_262767352_baidusearch&amp;utm_term=25517772975_0_1403f3d34e3a454fa57ff079a7ca4130" target="_blank" rel="external"><strong>Android群英传</strong></a></li>
<li><a href="http://www.cnblogs.com/zhguang/p/3257367.html" target="_blank" rel="external"><strong>Java系列笔记(3)-Java内存区域和GC机制</strong></a></li>
<li><a href="http://gityuan.com/2016/01/09/java-memory/" target="_blank" rel="external"><strong>Jvm内存模型</strong></a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/12/Java同步/" itemprop="url">
                  Java同步
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-12T19:24:57+08:00" content="2016-06-12">
              2016-06-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/translation/" itemprop="url" rel="index">
                    <span itemprop="name">translation</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/12/Java同步/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/12/Java同步/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍Java中同步的概念、类型、使用等相关内容。</p>
<h1>相关概念</h1>
<h2>Java同步</h2>
<ul>
<li><strong>Java同步</strong>是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;控制多线程访问任意共享资源的能力&lt;/font&gt;&lt;/u&gt;</li>
<li>在想要&lt;u&gt;&lt;font color=&quot;red&quot;&gt;允许唯一一个线程访问共享资源&lt;/font&gt;&lt;/u&gt;时Java同步是一种更好的选择</li>
</ul>
<h2>为什么使用同步</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;阻止线程干涉&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;阻止一致性问题&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>同步类型</h2>
<ul>
<li><strong>进程同步</strong></li>
<li><strong>线程同步</strong></li>
</ul>
<h2>线程同步</h2>
<ul>
<li><strong>互斥锁</strong></li>
<li><strong>协作</strong>（Java线程间通信）</li>
</ul>
<h2>Java锁的概念</h2>
<ul>
<li><strong>同步</strong>是由称为<strong>锁</strong>或<strong>监视器</strong>的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;内部实体&lt;/font&gt;&lt;/u&gt;构建</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每个对象有一个与之关联的锁&lt;/font&gt;&lt;/u&gt;</li>
<li>按照惯例，一个需要&lt;u&gt;&lt;font color=&quot;red&quot;&gt;持续访问一个对象的域&lt;/font&gt;&lt;/u&gt;的线程不得不&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在访问之前获取对象的锁，当完成访问后释放该锁&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h1>互斥锁</h1>
<p>互斥锁&lt;u&gt;&lt;font color=&quot;red&quot;&gt;帮助在共享数据时阻止线程相互干涉&lt;/font&gt;&lt;/u&gt;</p>
<h2>Java同步方法</h2>
<ul>
<li>同步方法因任意共享资源用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;锁定一个对象&lt;/font&gt;&lt;/u&gt;</li>
<li>当一个线程调用同步方法时，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;自动获取对象的锁，并且当线程完成任务时释放该锁&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>Java同步块</h2>
<ul>
<li>同步块因任意共享资源用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;锁定一个对象&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;同步块的作用范围比同步方法更小&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>Java静态同步</h2>
<ul>
<li>如果&lt;u&gt;&lt;font color=&quot;red&quot;&gt;让任意的静态方法同步&lt;/font&gt;&lt;/u&gt;，这个锁会&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在类上而不是对象上&lt;/font&gt;&lt;/u&gt;</li>
<li>也可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在同步块上使用类锁&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h1>Java死锁</h1>
<ul>
<li><strong>Java死锁</strong>是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;多线程的一部分&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>死锁发生情况</strong>：&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个对象等待被另一个线程获取的对象锁，并且另一个线程也在等待被第一个线程获取的对象锁&lt;/font&gt;&lt;/u&gt;。因为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;两个线程都在等待对方释放对象锁&lt;/font&gt;&lt;/u&gt;，这种情况称为死锁</li>
</ul>
<h1>Java线程间通信</h1>
<ul>
<li><strong>线程间通信</strong>或<strong>协作</strong>是关于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;允许同步线程相互通信&lt;/font&gt;&lt;/u&gt;</li>
<li>协作（线程间通信）是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一种机制&lt;/font&gt;&lt;/u&gt;，即&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在关键部分运行着的线程被暂停，同时另一个线程在同一关键部分被允许进入或锁住&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>wait()</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;引起当前线程释放锁&lt;/font&gt;&lt;/u&gt;，直到另一个线程要么调用<code>notify()</code>或<code>notifyAll()</code>方法或&lt;u&gt;&lt;font color=&quot;red&quot;&gt;指定的时间已经过去&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;当前线程必须拥有对象的监视器&lt;/font&gt;&lt;/u&gt;，所以<code>wait()</code>方法必须&lt;u&gt;&lt;font color=&quot;red&quot;&gt;从同步方法内被调用，否则会抛出异常&lt;/font&gt;&lt;/u&gt;</li>
<li><strong>public final void wait() throws InterruptedException</strong>: 等待直到对象被通知</li>
<li><strong>public final void wait(long timeout) throws InterruptedException</strong>: 等待指定的时间</li>
</ul>
<h2>notify()</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;唤醒正在等待这个对象的监视器的一个单独线程&lt;/font&gt;&lt;/u&gt;</li>
<li>如果一些线程正在这个对象上等待，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;其中一个线程被选择唤醒&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;这种选择是随意的，并且由执行自行决定&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>notifyAll()</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;唤醒等待这个对象的监视器的所有线程&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>理解线程间通信的过程</h2>
<ol>
<li>线程开始获取锁</li>
<li>锁被线程获取</li>
<li>如果调用<code>wait()</code>方法，线程进入暂停状态，否则线程释放锁并退出</li>
<li>如果调用<code>notify()</code>或<code>notifyAll()</code>方法，线程进入被通知状态(可运行状态)</li>
<li>线程可获取锁</li>
<li>任务完成后，线程释放锁，并退出对象的监视状态</li>
</ol>
<h2>特点</h2>
<p><code>wait()</code>，<code>notifiy()</code>和<code>notifyAll()</code>方法&lt;u&gt;&lt;font color=&quot;red&quot;&gt;与锁关联，并且对象有锁&lt;/font&gt;&lt;/u&gt;，所以这些方法被定义在<code>Object</code>类而不是<code>Thread</code>类</p>
<h2>wait()和sleep()方法的区别</h2>
<table>
<thead>
<tr>
<th style="text-align:left">wait()</th>
<th style="text-align:left">sleep()</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">wait() method releases the lock</td>
<td style="text-align:left">sleep() method doesn't release the lock.</td>
</tr>
<tr>
<td style="text-align:left">is the method of Object class</td>
<td style="text-align:left">is the method of Thread class</td>
</tr>
<tr>
<td style="text-align:left">is the non-static method</td>
<td style="text-align:left">is the static method</td>
</tr>
<tr>
<td style="text-align:left">is the non-static method</td>
<td style="text-align:left">is the static method</td>
</tr>
<tr>
<td style="text-align:left">should be notified by notify() or notifyAll() methods</td>
<td style="text-align:left">after the specified amount of time, sleep is completed.</td>
</tr>
</tbody>
</table>
<h1>中断线程</h1>
<ul>
<li>如果一个线程正在休眠或等待状态（sleep()或wait()方法被调用），在这个线程上调用<code>interrupt()</code>方法，会&lt;u&gt;&lt;font color=&quot;red&quot;&gt;打破休眠或等待状态，抛出异常&lt;/font&gt;&lt;/u&gt;</li>
<li>如果一个线程不在休眠或等待状态，调用<code>interrupt()</code>方法&lt;u&gt;&lt;font color=&quot;red&quot;&gt;表现正常的行为，不中断线程&lt;/font&gt;&lt;/u&gt;，但是设置中断标记为<code>true</code></li>
<li><strong>public void interrupt()</strong></li>
<li><strong>public static boolean interrupted()</strong></li>
<li><strong>public boolean isInterrupted()</strong>: 返回中断的标记（<code>true</code>或<code>false</code>）</li>
</ul>
<h1>重进入监视器</h1>
<ul>
<li>如果一个方法可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;从方法内部调用&lt;/font&gt;&lt;/u&gt;，Java线程因不同的同步方法&lt;u&gt;&lt;font color=&quot;red&quot;&gt;可重用同一监视器&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;终结了单线程死锁的可能性&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h1>参考方案</h1>
<p><a href="http://www.javatpoint.com/synchronization-in-java" target="_blank" rel="external"><strong>Synchronization in Java</strong></a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/07/Java多线程/" itemprop="url">
                  Java多线程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-07T09:13:25+08:00" content="2016-06-07">
              2016-06-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/java/translation/" itemprop="url" rel="index">
                    <span itemprop="name">translation</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/07/Java多线程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/07/Java多线程/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍Java中线程的概念及使用、多线程的优势及应用、垃圾收集的原理等</p>
<h1>相关概念</h1>
<h2>多任务</h2>
<p><code>Multitasking</code>，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;同时执行多个任务的过程&lt;/font&gt;&lt;/u&gt;，可以用于充分利用CPU。</p>
<ol>
<li>
<p><strong>基于进程的多任务</strong></p>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每个进程在内存中有自己的地址&lt;/font&gt;&lt;/u&gt;（每个进程分配独立的内存区）</li>
<li>进程是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;重量级&lt;/font&gt;&lt;/u&gt;的</li>
<li>进程间通信的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;代价是昂贵&lt;/font&gt;&lt;/u&gt;的</li>
<li>从一个进程切换到另一个进程需要一段时间保存和备份寄存器、内存映射区、更新列表等</li>
</ul>
</li>
<li>
<p><strong>基于线程的多任务</strong></p>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;线程共享同一地址空间</li>
<li>线程是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;轻量级&lt;/font&gt;&lt;/u&gt;的</li>
<li>线程间通信的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;代价很低&lt;/font&gt;&lt;/u&gt;</li>
</ul>
</li>
</ol>
<p>&lt;!-- more --&gt;</p>
<h2>线程</h2>
<ol>
<li>线程是一个&lt;u&gt;&lt;font color=&quot;red&quot;&gt;轻量级的子进程&lt;/font&gt;&lt;/u&gt;，一个&lt;u&gt;&lt;font color=&quot;red&quot;&gt;最小处理单元&lt;/font&gt;&lt;/u&gt;</li>
<li>线程是一个&lt;u&gt;&lt;font color=&quot;red&quot;&gt;单独的执行路径&lt;/font&gt;&lt;/u&gt;</li>
<li>线程是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;独立&lt;/font&gt;&lt;/u&gt;的，如果一个线程中发生异常，该线程&lt;u&gt;&lt;font color=&quot;red&quot;&gt;并不影响其它线程&lt;/font&gt;&lt;/u&gt;</li>
<li>线程&lt;u&gt;&lt;font color=&quot;red&quot;&gt;共享通用内存区&lt;/font&gt;&lt;/u&gt;</li>
<li>线程&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在进程里被执行&lt;/font&gt;&lt;/u&gt;</li>
<li>线程间&lt;u&gt;&lt;font color=&quot;red&quot;&gt;存在上下文切换&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每次只有一个线程被执行&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h2>Java多线程</h2>
<h3>概念</h3>
<ul>
<li><code>Java多线程</code>是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;同时执行多个线程的过程&lt;/font&gt;&lt;/u&gt;</li>
<li>使用多线程而不是多进程，是因为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;线程共享通用内存区&lt;/font&gt;&lt;/u&gt;，它们不需要分配独立的内存区，可以节省内存，同时&lt;u&gt;&lt;font color=&quot;red&quot;&gt;线程间的上下文切换比进程间更省时&lt;/font&gt;&lt;/u&gt;。</li>
</ul>
<h3>优势</h3>
<ol>
<li>因为线程是独立的，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;不会堵塞用户，并且可以同时执行多个操作&lt;/font&gt;&lt;/u&gt;</li>
<li>可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;同时执行许多操作来节省时间&lt;/font&gt;&lt;/u&gt;</li>
<li>线程是独立的，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;如果一个线程发生异常了，它不会影响其它线程&lt;/font&gt;&lt;/u&gt;</li>
</ol>
<h1>线程相关点</h1>
<h2>生命周期（状态）</h2>
<p>Java中线程的生命周期由<code>JVM</code>控制，如下图所示</p>
<p><img src="/images/java-multithreading/thread-5-states.jpg" alt=""></p>
<ol>
<li><strong>New</strong>：如果你创建了一个线程实例，但还未调用<code>start()</code>方法，此时该线程处于<strong>新建状态</strong></li>
<li><strong>Runnable</strong>：在调用<code>start()</code>方法后线程处于<strong>可运行状态</strong>，但是线程调度器还未选中该线程作为运行时线程</li>
<li><strong>Running</strong>：如果线程调度器选中个一个线程，则该线程处于<strong>运行时状态</strong></li>
<li><strong>Non-Runnable（Blocked）</strong>：当线程还存活时该线程处于<strong>不可运行（堵塞）状态</strong>，但是该线程当前不能运行</li>
<li><strong>Terminated</strong>：当线程的<code>run()</code>方法存在时该线程处于<strong>终止/死亡状态</strong></li>
</ol>
<h2>create()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;创建线程&lt;/font&gt;&lt;/u&gt;，有以下两种方式</p>
<h3>继承Thread类</h3>
<ul>
<li>线程类提供了&lt;u&gt;&lt;font color=&quot;red&quot;&gt;构造函数&lt;/font&gt;&lt;/u&gt;和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;方法&lt;/font&gt;&lt;/u&gt;来创建和执行线程操作</li>
<li>线程类继承<code>Object</code>类，实现<code>Runnable</code>接口</li>
</ul>
<h3>实现Runnable接口</h3>
<ul>
<li><code>Runnable</code>接口应该由想要&lt;u&gt;&lt;font color=&quot;red&quot;&gt;被线程执行的类&lt;/font&gt;&lt;/u&gt;实现</li>
<li><code>Runnable</code>接口只有一个<code>run()</code>方法</li>
</ul>
<h2>start()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;启动一个新建的线程&lt;/font&gt;&lt;/u&gt;，执行以下任务</p>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个新建的线程启动&lt;/font&gt;&lt;/u&gt;（包括<strong>调用堆栈</strong>）</li>
<li>线程从<code>New</code>状态变换到<code>Runnable</code>状态</li>
<li>当线程得到机会执行时，它的<code>run()</code>方法会执行</li>
</ul>
<h2>启动线程两次</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个线程启动后，不会再次被启动&lt;/font&gt;&lt;/u&gt;</li>
<li>如果再次启动同一线程，会抛出<code>IllegalThreadStateException</code>。&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在这种情况下，线程会运行一次，但在几秒之后会抛出异常&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>调用run()方法</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每个线程在单独的调用堆栈里启动&lt;/font&gt;&lt;/u&gt;</li>
<li>从主线程调用<code>run()</code>方法，会&lt;u&gt;&lt;font color=&quot;red&quot;&gt;进入到当前调用堆栈而不是新建调用堆栈&lt;u&gt;&lt;font color=&quot;red&quot;&gt;</li>
</ul>
<h2>sleep()</h2>
<p>用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;休眠一个进程指定的时间&lt;/font&gt;&lt;/u&gt;。线程提供两种方法休眠一个进程</p>
<ul>
<li><strong>public static void sleep(long miliseconds) throws InterruptedException</strong></li>
<li><strong>public static void sleep(long miliseconds, int nanos) throws InterruptedException</strong></li>
</ul>
<h2>join()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;等待一个线程死亡&lt;/font&gt;&lt;/u&gt;。换句话说，<code>join()</code>方法引起当前运行着的线程停止执行知道联合的线程完成任务</p>
<h2>命名线程</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;线程提供方法修改和获取线程的名字&lt;/font&gt;&lt;/u&gt;</p>
<ul>
<li><strong>public String getName()</strong>：用于返回一个线程的名字</li>
<li><strong>public void setName(String name)</strong>：用于修改一个线程的名字</li>
</ul>
<h2>currentThread()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;返回当前执行线程对象的引用&lt;/font&gt;&lt;/u&gt;</p>
<h2>线程优先级</h2>
<h3>概念</h3>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每个线程有一个优先级&lt;/font&gt;&lt;/u&gt;</li>
<li>优先级可以使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;1~10的数字&lt;/font&gt;&lt;/u&gt;来描述</li>
<li>大多数情况下线程调度器&lt;u&gt;&lt;font color=&quot;red&quot;&gt;根据优先级&lt;/font&gt;&lt;/u&gt;（<strong>抢占式调度</strong>）来调度线程，但是不能保证因为依赖于JVM的规范选择哪种调度方式</li>
</ul>
<h3>线程定义的3个常量</h3>
<ul>
<li><strong>public static int MIN_PRIORITY</strong></li>
<li><strong>public static int NORM_PRIORITY</strong></li>
<li><strong>public static int MAX_PRIORITY</strong></li>
</ul>
<p>一个线程的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;默认优先级是5&lt;/font&gt;&lt;/u&gt;（NORM_PRIORITY），MIN_PRIORITY的值为1，MAX_PRIORITY的值为10</p>
<h2>守护线程</h2>
<h3>概念</h3>
<ul>
<li>Java中的<strong>守护线程</strong>是一个提供服务线程，可以为用户线程提供服务</li>
<li>它的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;生命周期依赖于用户线程&lt;/font&gt;&lt;/u&gt;，当所有的用户线程都死亡后，JVM自动终止这个线程</li>
<li>有一些&lt;u&gt;&lt;font color=&quot;red&quot;&gt;自动运行&lt;/font&gt;&lt;/u&gt;着的守护线程，如finalizer。</li>
</ul>
<h3>特征</h3>
<ul>
<li>为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;支持后台任务&lt;/font&gt;&lt;/u&gt;，提供服务给用户线程，其生命周期中只有服务用户线程的角色</li>
<li>生命周期依赖于用户线程</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;低优先级&lt;/font&gt;&lt;/u&gt;的线程</li>
</ul>
<h3>若没有用户线程，JVM终止守护线程</h3>
<p>守护线程的&lt;u&gt;&lt;font color=&quot;red&quot;&gt;单独目的是为支持后台任务&lt;/font&gt;&lt;/u&gt;，提供服务给用户线程。如果没有用户线程了，JVM为何要一直运行此线程呢？</p>
<h1>线程调度器</h1>
<ul>
<li>线程是JVM的一部分，用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;决定哪个线程应该运行&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;没有保证哪个可运行的线程被线程调度器选中运行&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在一个单独的进程中，一次只要一个线程可以运行&lt;/font&gt;&lt;/u&gt;</li>
<li>线程调度器主要使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;抢占式调度&lt;/font&gt;&lt;/u&gt;或&lt;u&gt;&lt;font color=&quot;red&quot;&gt;时间分片调度&lt;/font&gt;&lt;/u&gt;来调度线程</li>
</ul>
<p><strong>Note</strong>：抢占式调度与时间分片调度的区别</p>
<ul>
<li>抢占式调度中，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;高优先级的任务执行，直到进入等待或死亡状态&lt;/font&gt;&lt;/u&gt;</li>
<li>时间分片中，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个任务执行一段预定时间片，然后重新进入准备任务池，调度器然后基于优先级和其它因素来决定接下来哪个任务应该执行&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h1>线程池</h1>
<h2>概念</h2>
<ul>
<li>线程池代表&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一组等待多次工作和重用的工作线程&lt;/font&gt;&lt;/u&gt;</li>
<li>在线程池的情况下，一组固定大小的线程被创建</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一个线程从线程池中被取出来，被服务提供者分配一个工作&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在工作完成后，线程再次保留在线程池中&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>优势</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;节省时间，因没有必要创建新线程&lt;/font&gt;&lt;/u&gt;</p>
<h1>线程组</h1>
<ul>
<li>Java提供了一种方式&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在一个单独的对象里组合多个线程，在这种情况下，可以通过一个单独的方法调用来实现一组线程的挂起、重启或中断&lt;/font&gt;&lt;/u&gt;</li>
<li>Java线程组被<code>java.lang.ThreadGroup</code>类实现</li>
</ul>
<h1>Java Shutdown Hook</h1>
<h2>概念</h2>
<ul>
<li><code>shutdown hook</code>用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;当JVM正常或异常关闭时执行清理资源或保存状态&lt;/font&gt;&lt;/u&gt;</li>
<li>执行清理资源意味着&lt;u&gt;&lt;font color=&quot;red&quot;&gt;关闭日志文件、发送警告或其它&lt;/font&gt;&lt;/u&gt;</li>
<li>在JVM关闭前若想要执行一些代码，使用<code>shutdown hook</code></li>
</ul>
<h2>JVM什么时候使用shutdown hook？</h2>
<ul>
<li>用户按下<code>Ctrl+C</code></li>
<li>调用<code>System.exit(int)</code>方法</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;用户注销&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;用户关闭&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>addShutdownHook(THread hook)</h2>
<p><code>Runtime</code>类的<code>addShutdownHook()</code>方法用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;注册虚拟机的线程&lt;/font&gt;&lt;/u&gt;。<code>Runtime</code>类的对象可以通过调用静态工厂方法<code>getRuntime()</code>来获取。</p>
<h1>执行多任务</h1>
<ul>
<li><strong>使用多线程执行单独的任务</strong>：如果需要被许多线程执行单独的任务，只需要拥有一个<code>run()</code>方法</li>
<li><strong>使用多线程执行多个任务</strong>：如果需要被许多线程执行多个任务，需要拥有多个<code>run()</code>方法</li>
</ul>
<h1>垃圾收集</h1>
<h2>概念</h2>
<ul>
<li>Java中垃圾意味着&lt;u&gt;&lt;font color=&quot;red&quot;&gt;不被引用的对象&lt;/font&gt;&lt;/u&gt;</li>
<li>垃圾收集是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一种自动回收运行时未使用内存的机制&lt;/font&gt;&lt;/u&gt;，换句话说，是一种销毁不再使用对象的方式</li>
<li><code>C</code>中使用<code>free()</code>，<code>C++</code>中使用<code>delete()</code>来收集垃圾。但<code>Java</code>中自动执行，所有<code>Java</code>提供了更好的内存管理</li>
</ul>
<h2>优势</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;让Java内存高效&lt;/font&gt;&lt;/u&gt;，因为垃圾收集从堆内存里移除了不被引用的对象</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;由垃圾收集自动完成&lt;/font&gt;&lt;/u&gt;，不需要做额外功</li>
</ul>
<h2>对象可以如何被未引用？</h2>
<ul>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;置空引用&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;把一个引用赋值给另一个引用&lt;/font&gt;&lt;/u&gt;</li>
<li>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;匿名类&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h2>finalize()</h2>
<ul>
<li>在对象被垃圾回收之前，<code>finalize()</code>方法每次都会被调用</li>
<li>该方法可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;执行清除操作&lt;/font&gt;&lt;/u&gt;</li>
<li>该方法在<code>Object</code>类里被定义</li>
<li><code>JVM</code>的垃圾收集器只回收使用<code>new</code>关键字创建的对象。所以如果没有使用<code>new</code>创建对象，可以使用<code>finalize()</code>方法执行清除操作</li>
</ul>
<h2>gc()</h2>
<ul>
<li>用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;调用垃圾回收器执行清除操作&lt;/font&gt;&lt;/u&gt;</li>
<li>该方法在<code>System</code>和<code>Runtime</code>类里被定义里</li>
<li>垃圾收集被一个叫<code>GC (Garbage Collection)</code>的守护线程执行。守护线程在对象被垃圾回收之前调用<code>finalize()</code>方法</li>
</ul>
<h1>Runtime</h1>
<ul>
<li><code>Runtime</code>类用于和<code>java运行时环境</code>交互</li>
<li><code>Runtime</code>类提供方法执行操作，如调用<code>GC</code>、获取全部和剩余内存等</li>
<li>对于一个Java应用来说，只有一个<code>java.lang.Runtime</code>类实例</li>
<li><code>Runtime.getRuntime()</code>方法返回<code>Runtime</code>类的实例</li>
</ul>
<h2>exec()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;在一个单独的进程里执行被提供的命令&lt;/font&gt;&lt;/u&gt;</p>
<h2>freeMemory()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;返回JVM里剩余内存&lt;/font&gt;&lt;/u&gt;</p>
<h2>totalMemory()</h2>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;返回JVM里全部内存&lt;/font&gt;&lt;/u&gt;</p>
<h1>参考方案</h1>
<p><a href="http://www.javatpoint.com/multithreading-in-java" target="_blank" rel="external"><strong>Multithreading in Java</strong></a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/05/Markdown语法、Jumly语法学习/" itemprop="url">
                  Markdown语法、Jumly语法学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-05T09:47:20+08:00" content="2016-06-05">
              2016-06-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index">
                    <span itemprop="name">learn</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/learn/tool/" itemprop="url" rel="index">
                    <span itemprop="name">tool</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/05/Markdown语法、Jumly语法学习/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/05/Markdown语法、Jumly语法学习/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>概况</h1>
<p>本文主要介绍下**<code>Markdown</code>的基本语法**&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;，以及如何使用**<code>Jumly</code>**&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;（译文）在Markdown中支持流表等</p>
<h1>Markdown语法</h1>
<h2>Markdown概述</h2>
<h3>宗旨</h3>
<p>Markdown 是一种&lt;u&gt;&lt;font color=&quot;red&quot;&gt;轻量级标记语言&lt;/font&gt;&lt;/u&gt;，创始人为约翰·格鲁伯（John Gruber）。它允许人们 使用易读易写的纯文本格式编写文档，然后转换成有效的XHTML(或者HTML)文档。</p>
<p>可读性，无论如何，都是最重要的。一份使用 Markdown 格式撰写的文件应该可以直接以纯文本发布，并且看起来不会像是由许多标签或是格式指令所构成。Markdown 语法受到一些既有 text-to-HTML 格式的影响，包括 <strong>Setext</strong>、<strong>atx</strong>、<strong>Textile</strong>、<strong>reStructuredText</strong>、<strong>Grutatext</strong> 和 <strong>EtText</strong>，而最大灵感来源其实是纯文本电子邮件的格式。</p>
<p>总之， Markdown 的语法全由一些符号所组成，这些符号经过精挑细选，其作用一目了然。比如：在文字两旁加上星号，看起来就像强调。Markdown 的列表看起来，嗯，就是列表。Markdown 的区块引用看起来就真的像是引用一段文字，就像你曾在电子邮件中见过的那样。</p>
<p>&lt;!-- more --&gt;</p>
<h3>兼容HTML</h3>
<p>Markdown 语法的目标是：成为&lt;u&gt;&lt;font color=&quot;red&quot;&gt;一种适用于网络的书写语言&lt;/font&gt;&lt;/u&gt;。</p>
<p>Markdown 不是想要取代 HTML，甚至也没有要和它相近，它的语法种类很少，只对应 HTML 标记的一小部分。Markdown 的构想不是要使得 HTML 文档更容易书写。在我看来， HTML 已经很容易写了。Markdown 的理念是，能让文档更容易读、写和随意改。HTML 是一种发布的格式，Markdown 是一种书写的格式。就这样，Markdown 的格式语法只涵盖纯文本可以涵盖的范围。</p>
<p>不在 Markdown 涵盖范围之内的标签，都可以直接在文档里面用 HTML 撰写。不需要额外标注这是 HTML 或是 Markdown，只要直接加标签就可以了。</p>
<p>要制约的只有一些 HTML 区块元素――比如**&lt;div&gt;<strong>、</strong>&lt;table&gt;<strong>、</strong>&lt;pre&gt;<strong>、</strong>&lt;p&gt;** 等标签，必须在前后加上空行与其它内容区隔开，还要求它们的开始标签与结尾标签不能用制表符或空格来缩进。Markdown 的生成器有足够智能，不会在 HTML 区块标签外加上不必要的 <strong>&lt;p&gt;</strong> 标签。</p>
<p>例子如下，在 Markdown 文件里加上一段 HTML 表格：</p>
<pre><code>这是一个普通段落。

&lt;table&gt;
&lt;tr&gt;
    &lt;td&gt;Foo&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

这是另一个普通段落。
</code></pre>
<p>请注意，在 HTML 区块标签间的 Markdown 格式语法将不会被处理。比如，你在 HTML 区块内使用 Markdown 样式的强调会没有效果。</p>
<p>HTML 的区段（行内）标签如 <strong>&lt;span&gt;</strong> 、<strong>&lt;cite&gt;</strong> 、<strong>&lt;del&gt;</strong>  可以在 Markdown 的段落、列表或是标题里随意使用。依照个人习惯，甚至可以不用 Markdown 格式，而直接采用 HTML 标签来格式化。举例说明：如果比较喜欢 HTML 的 <strong>&lt;a&gt;</strong>  或 <strong>&lt;img&gt;</strong>  标签，可以直接使用这些标签，而不用 Markdown 提供的链接或是图像标签语法。</p>
<p>和处在 HTML 区块标签间不同，Markdown 语法在 HTML 区段标签间是有效的。</p>
<h2>块元素</h2>
<h3>段落和换行</h3>
<p><strong>段落</strong>只是被至少一个空行分隔的至少一行文本内容，空行是只有空格或Tabs的一行。正常的段落不应该使用空格或Tabs缩进。</p>
<p>使用Markdown时若想要<strong>换行</strong>，可以使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;2个以上的空格&lt;/font&gt;&lt;/u&gt;和**<code>return</code>**来结束该行。</p>
<h3>标题</h3>
<p>Markdown支持两种标题风格，<strong><code>Setext</code></strong>&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;和**<code>atx</code>**&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;</p>
<ol>
<li>
<p><strong>Setext风格标题</strong></p>
<p>使用**<code>=</code><strong>（第一级别标题）和</strong><code>-</code>**（第二级别标题）来描述</p>
<pre><code>This is an H1
=============

This is an H2
-------------
</code></pre>
</li>
<li>
<p><strong>atx风格标题</strong></p>
<p>使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;1~6个&lt;/font&gt;&lt;/u&gt;**<code>#</code>**放在行的开头，对应&lt;u&gt;&lt;font color=&quot;red&quot;&gt;级别1~6&lt;/font&gt;&lt;/u&gt;的标题</p>
<pre><code># This is an H1

## This is an H2

###### This is an H6
</code></pre>
</li>
</ol>
<h3>块引用</h3>
<ol>
<li>
<p>Markdown使用邮件风格的**<code>&gt;</code>**字符</p>
</li>
<li>
<p>Markdown允许只在&lt;u&gt;&lt;font color=&quot;red&quot;&gt;段落的第一行&lt;/font&gt;&lt;/u&gt;添加**<code>&gt;</code>**（使用大于号和空格表示）</p>
</li>
<li>
<p>块引用可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;嵌套&lt;/font&gt;&lt;/u&gt;，即使用额外的**<code>&gt;</code>**</p>
<blockquote>
<p>This is the first level of quoting.</p>
<blockquote>
<p>This is nested blockquote.</p>
</blockquote>
<p>Back to the first level.</p>
</blockquote>
</li>
<li>
<p>块引用可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;包含其它的Markdown元素&lt;/font&gt;&lt;/u&gt;，包括标题、列表和代码块等</p>
<blockquote>
<h2>This is a header</h2>
<ol>
<li>This is the first list item.</li>
<li>This is the second list item.</li>
</ol>
</blockquote>
</li>
</ol>
<h3>列表</h3>
<p>Markdown支持<strong>有序</strong>和<strong>无序</strong>列表</p>
<ol>
<li>
<p>无序列表使用**<code>*</code><strong>、</strong><code>+</code><strong>、</strong><code>-</code>**（可以互换）作为列表标记</p>
</li>
<li>
<p>有序列表使用<strong>数字</strong>来作为列表标记，<strong>注意</strong>用于列表标记的具体数字对HTML输出没有影响</p>
</li>
<li>
<p>列表标记后必须跟着&lt;u&gt;&lt;font color=&quot;red&quot;&gt;至少一个空格或Tab&lt;/font&gt;&lt;/u&gt;</p>
</li>
<li>
<p>列表条目可以有多个段落，每个段落&lt;u&gt;&lt;font color=&quot;red&quot;&gt;要么使用4个空格，要么一个Tab来缩进&lt;/font&gt;&lt;/u&gt;</p>
</li>
<li>
<p>在列表条目中&lt;u&gt;&lt;font color=&quot;red&quot;&gt;添加块引用&lt;/font&gt;&lt;/u&gt;时，需要在缩进后添加**<code>&gt;</code>**</p>
<ul>
<li>A list item with a blockquote</li>
</ul>
<blockquote>
<p>This is a blockquote
inside a list item.</p>
</blockquote>
</li>
<li>
<p>在列表条目中&lt;u&gt;&lt;font color=&quot;red&quot;&gt;添加代码块&lt;/font&gt;&lt;/u&gt;，需要缩进2次，即8个空格或2个Tabs</p>
<ul>
<li>A list item with a code block
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printName</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3>代码块</h3>
<ul>
<li>
<p>预格式化代码块用于写程序或标记源代码，代码块的一行在字面上被解释，而不是形成正常的段落。</p>
</li>
<li>
<p>Markdown把代码块封装在**&lt;pre&gt;<strong>和</strong>&lt;code&gt;**标签中。</p>
</li>
<li>
<p>在Markdown中为了生成一个代码块，只是简单缩进&lt;u&gt;&lt;font color=&quot;red&quot;&gt;每行4个空格或1个Tab&lt;/font&gt;&lt;/u&gt;即可。</p>
<pre><code>tell application &quot;Foo&quot;
     beep
 end tell 
</code></pre>
</li>
<li>
<p>代码块的范围是&lt;u&gt;&lt;font color=&quot;red&quot;&gt;直到文章末尾或有一行没有缩进&lt;/font&gt;&lt;/u&gt;</p>
</li>
<li>
<p>代码块内，<strong><code>&amp;</code><strong>符号和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;尖括号&lt;/font&gt;&lt;/u&gt;（</strong><code>&lt;</code></strong>、<strong><code>&gt;</code></strong>）是自动转换为HTML实体，这使得使用Markdown很容易就实现包含HTML代码，只是简单粘贴和缩进。</p>
<pre><code>&lt;div class=&quot;footer&quot;&gt;
	&amp;copy; 2004 Foo Corporation
&lt;/div&gt;
</code></pre>
</li>
</ul>
<h3>水平线</h3>
<p>在一行中使用至少三个**<code>-</code><strong>、</strong><code>*</code><strong>、</strong><code>_</code><strong>可以生成一条水平线，当然也可以在</strong><code>-</code><strong>或</strong><code>*</code>**使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;空格&lt;/font&gt;&lt;/u&gt;隔开。</p>
<h2>跨度元素</h2>
<h3>链接</h3>
<p>Markdown支持**<code>inline</code><strong>和</strong><code>reference</code>**两种类型链接</p>
<ul>
<li>
<p><strong>inline</strong>：以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;中括号&lt;/font&gt;&lt;/u&gt;标记显示的链接文本，后面紧跟用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;小括号&lt;/font&gt;&lt;/u&gt;包围的链接。如果链接有title属性，则在链接中使用&lt;u&gt;&lt;font color=&quot;red&quot;&gt;空格加&quot;title属性&quot;&lt;/font&gt;&lt;/u&gt;。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">This is [an example](http://example.com/ &quot;Title&quot;) inline link.</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>reference</strong>：一般应用于&lt;u&gt;&lt;font color=&quot;red&quot;&gt;多个不同位置使用相同链接&lt;/font&gt;&lt;/u&gt;。通常分为两个部分，&lt;u&gt;&lt;font color=&quot;red&quot;&gt;调用部分&lt;/font&gt;&lt;/u&gt;为链接文本；&lt;u&gt;&lt;font color=&quot;red&quot;&gt;定义部分&lt;/font&gt;&lt;/u&gt;可以出现在文本中的其他位置，格式为 ref: http://some/link/address (可选的标题)。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">This is [an example][id] reference-style link.</div><div class="line"></div><div class="line">[id]: http://example.com/  &quot;Optional Title Here&quot;</div></pre></td></tr></table></figure></p>
</li>
</ul>
<h3>强调</h3>
<ul>
<li>Markdown使用**<code>*</code><strong>和</strong><code>_</code><strong>来着重强调。使用一个</strong><code>*</code><strong>或</strong><code>_</code><strong>封装的文本可以被带有</strong>&lt;em&gt;<strong>的HTML标签封装，使用两个</strong><code>*</code><strong>或</strong><code>_</code><strong>封装的文本可以被带有</strong>&lt;strong&gt;**的HTML标签封装。</li>
<li>还可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;对一个单词的部分内容使用强调&lt;/font&gt;&lt;/u&gt;</li>
</ul>
<h3>代码</h3>
<ul>
<li>
<p>使用反引号**<code>`</code>**来指示其跨度，不像预格式化的代码块，一段代码的跨度表明在一个段落里。</p>
</li>
<li>
<p>为了在一个代码跨度里包含反引号，可以&lt;u&gt;&lt;font color=&quot;red&quot;&gt;使用多个反引号来当作开闭分隔符&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">``There is a literal backtick (`) here.``</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>围绕一个代码跨度的反引号分隔符可能&lt;u&gt;&lt;font color=&quot;red&quot;&gt;包括空格，开始后一个，关闭前一个&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">A single backtick in a code span: `` ` ``</div></pre></td></tr></table></figure></p>
</li>
</ul>
<h3>图片</h3>
<p>图片的使用方法基本上和链接类似，只是在中括号前加叹号。</p>
<ul>
<li>
<p><strong>inline</strong></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">![Alt text](/path/to/img.jpg)</div><div class="line"></div><div class="line">![Alt text](/path/to/img.jpg &quot;Optional title&quot;)</div></pre></td></tr></table></figure></p>
</li>
<li>
<p><strong>reference</strong></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">![Alt text][id]</div><div class="line"></div><div class="line">[id]: url/to/image  &quot;Optional title attribute&quot;</div></pre></td></tr></table></figure></p>
</li>
</ul>
<h2>其它</h2>
<h3>自动链接</h3>
<p>Markdown为URLs和邮件地址提供创建自动连接的快捷方式，即&lt;u&gt;&lt;font color=&quot;red&quot;&gt;使用<strong>尖括号</strong>来包围URLs或邮件地址&lt;/font&gt;&lt;/u&gt;。</p>
<pre><code>&lt;http://example.com/&gt;

&lt;address@example.com&gt;
</code></pre>
<h3>转义</h3>
<p>Markdown中的转义字符为**<code>\</code>**</p>
<pre><code>\\ 反斜杠
\` 反引号
\* 星号
\_ 下划线
\{\} 大括号
\[\] 中括号
\(\) 小括号
\# 井号
\+ 加号
\- 减号
\. 英文句号
\! 感叹号
</code></pre>
<h1>Jumly语法</h1>
<h2>概述</h2>
<p>Jumly是一个&lt;u&gt;&lt;font color=&quot;red&quot;&gt;用于UML画图渲染引擎的JavaScript库&lt;/font&gt;&lt;/u&gt;，工作原理完全在客户端。使用Jumly，可以很容易将时尚的UML图标嵌入到HTML文档中。</p>
<h2>指令</h2>
<h3>Sequence Diagram</h3>
<h4><strong>@found</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;开始交互的顶级元素&lt;/font&gt;&lt;/u&gt;，将&lt;u&gt;&lt;font color=&quot;red&quot;&gt;参与者&lt;/font&gt;&lt;/u&gt;与&lt;u&gt;&lt;font color=&quot;red&quot;&gt;生命线&lt;/font&gt;&lt;/u&gt;（虚线表示）和&lt;u&gt;&lt;font color=&quot;red&quot;&gt;发生的事&lt;/font&gt;&lt;/u&gt;（灰色边界矩形）放在一起</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@found &quot;He&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-0.png" alt=""></p>
<p>可以使用**<code>-&gt;</code><strong>来&lt;u&gt;&lt;font color=&quot;red&quot;&gt;显示发生的事的交互&lt;/font&gt;&lt;/u&gt;，使用缩进（2个空格或1个Tab）并且写如</strong>@message**的其它指令</p>
<h4><strong>@message</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;两个参与者或自调用之间的交互&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@found &quot;He&quot;,  -&gt;</div><div class="line">	@message &quot;calls&quot;, &quot;Her&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-1.png" alt=""></p>
<p>如果第二个参数未提供，则表示&lt;u&gt;&lt;font color=&quot;red&quot;&gt;自调用&lt;/font&gt;&lt;/u&gt;</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@found &quot;He&quot;,  -&gt;</div><div class="line">	@message &quot;thinks&quot;,</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-2.png" alt=""></p>
<p>可以在上述两种情况下将**<code>-&gt;</code>**放在&lt;u&gt;&lt;font color=&quot;red&quot;&gt;最后一个参数后面&lt;/font&gt;&lt;/u&gt;，用于嵌套的交互</p>
<h4><strong>@create</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;新建一个交互&lt;/font&gt;&lt;/u&gt;，参与者的名字即给定的参数名，创建的参与者会向下移动，并且箭头是虚线形式</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@found &quot;He&quot;,  -&gt;</div><div class="line">	@create &quot;Contact&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-3.png" alt=""></p>
<p><strong>可选</strong>：将**<code>-&gt;</code>**作为第二个参数；也可以结合其它指令</p>
<h4><strong>@reply</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;显示回调的信息&lt;/font&gt;&lt;/u&gt;，可以和一个简短说明的参数放在一个**@message**指令里</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@found &quot;Browser&quot;, -&gt;</div><div class="line">	@message &quot;GET&quot;, &quot;Server&quot;, -&gt;</div><div class="line">		@reply &quot;200&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-4.png" alt=""></p>
<h4><strong>@alt</strong></h4>
<p>一种碎片，通常&lt;u&gt;&lt;font color=&quot;red&quot;&gt;形成带有一些交互的2个或多个条件部分&lt;/font&gt;&lt;/u&gt;。<strong>@alt</strong>的一部分由一对文本和**<code>-&gt;</code><strong>组成，可以在</strong>@alt**里存放多对</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@found &quot;You&quot;, -&gt;</div><div class="line">	@alt</div><div class="line">		&quot;[male]&quot;: -&gt;</div><div class="line">			@message &quot;pay with a card&quot;, &quot;Bar&quot;, -&gt;</div><div class="line">				@message &quot;auth the card&quot;, &quot;Visa&quot;</div><div class="line">		&quot;[female]&quot;: -&gt;</div><div class="line">			@message &quot;wait for his payment&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-5.png" alt=""></p>
<h4><strong>@loop</strong></h4>
<p>一种碎片，显示&lt;u&gt;&lt;font color=&quot;red&quot;&gt;重复&lt;/font&gt;&lt;/u&gt;。一个亮灰色的矩形表示一个循环</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@found &quot;You&quot;, -&gt;</div><div class="line">	@loop &quot;[until she answer]&quot;, -&gt;</div><div class="line">		@message &quot;call&quot;, &quot;Her&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-6.png" alt=""></p>
<h4><strong>@fragment</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;泛型指令&lt;/font&gt;&lt;/u&gt;，生成如**@alt<strong>和</strong>@loop**的碎片</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@found &quot;Thread-A&quot;, -&gt;</div><div class="line">	@fragment &quot;critical section&quot;: -&gt;</div><div class="line">		@message &quot;acquire&quot;, &quot;Mutex&quot;</div><div class="line">		@message &quot;do something&quot;</div><div class="line">		@message &quot;release&quot;, &quot;Mutex&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-7.png" alt=""></p>
<h4><strong>@ref</strong></h4>
<p>&lt;u&gt;&lt;font color=&quot;red&quot;&gt;移动到另一个图表&lt;/font&gt;&lt;/u&gt;的指令</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@found &quot;MacOX&quot;, -&gt;</div><div class="line">	@ref &quot;initialize&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-8.png" alt=""></p>
<h4><strong>@note</strong></h4>
<p>存放&lt;u&gt;&lt;font color=&quot;red&quot;&gt;注意提示&lt;/font&gt;&lt;/u&gt;的指令</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@found &quot;She&quot;, -&gt;</div><div class="line">	@note &quot;Eventually&quot;</div><div class="line">	@message &quot;meets&quot;, &quot;You&quot;, -&gt;</div><div class="line">		@note &quot;can&apos;t do anything then&quot;</div><div class="line">	@note &quot;Just say goodbye...&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/images/markdown_jumly/Markdown%E8%AF%AD%E6%B3%95-Jumly%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0-diagram-9.png" alt=""></p>
<p>&lt;div id=&quot;footnotes&quot;&gt;&lt;hr&gt;&lt;div id=&quot;footnotelist&quot;&gt;&lt;ol style=&quot;list-style:none; padding-left: 0;&quot;&gt;&lt;li id=&quot;fn:1&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;1.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;<a href="https://daringfireball.net/projects/markdown/syntax" target="_blank" rel="external">&lt;strong&gt;Markdown: Syntax&lt;/strong&gt;</a>&lt;/span&gt;&lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;fn:2&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;2.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;<a href="http://jumly.tmtk.net/" target="_blank" rel="external">&lt;strong&gt;Jumly&lt;/strong&gt;</a>&lt;/span&gt;&lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;fn:3&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;3.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;Structure-enhanced text，<a href="http://docutils.sourceforge.net/mirror/setext.html" target="_blank" rel="external">文档地址</a>&lt;/span&gt;&lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;fn:4&quot;&gt;&lt;span style=&quot;display: inline-block; vertical-align: top; padding-right: 10px;&quot;&gt;4.&lt;/span&gt;&lt;span style=&quot;display: inline-block; vertical-align: top;&quot;&gt;atx, the true structured text format，<a href="http://www.aaronsw.com/2002/atx/" target="_blank" rel="external">文档地址</a>&lt;/span&gt;&lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt; ↩&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/my_avatar.jpg"
               alt="Jeff" />
          <p class="site-author-name" itemprop="name">Jeff</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">22</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jeff</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"duslee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  

  

  

</body>
</html>
